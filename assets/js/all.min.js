$.fn.extend({isOnScreenVisible:function(){var o=$(window),e={top:o.scrollTop(),left:o.scrollLeft()};e.right=e.left+o.width(),e.bottom=e.top+o.height();var t=this.offset();return t.right=t.left+this.outerWidth(),t.bottom=t.top+this.outerHeight(),!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}});var Duoshuo={dataThreadKey:location.protocol+"//"+location.host+location.pathname,init:function(){Duoshuo.toggleBox()},toggleBox:function(){$(".toggle-comment").on("click",function(){if($(".comment-area").has("div").length>0)return void $(".comment-area").empty();var o=document.createElement("div");o.setAttribute("data-thread-key",Duoshuo.dataThreadKey),o.setAttribute("data-url",location.href),DUOSHUO.EmbedThread(o),$(".comment-area").append(o),setTimeout(function(){$(".comment-area").addClass("toggle-up")},500),setTimeout(function(){1==$(".comment-area").isOnScreenVisible()&&$(".toggle-comment").addClass("animated fadeOut").fadeOut(500)},1e3)})}},General={init:function(){General.scrollToPos(),General.checkKey(),General.updateImageWidth()},checkKey:function(o){o=o||window.event,"74"==o.keyCode?(console.log("按下键盘"),$("html,body").stop(),$("html,body").animate({scrollTop:$(window).stop().scrollTop()+200},"fast")):"75"==o.keyCode&&($("html,body").stop(),$("html,body").animate({scrollTop:$(window).stop().scrollTop()-200},"fast"))},updateImageWidth:function(){function o(){var o=$(this),e=t.outerWidth(),i=this.naturalWidth;i>=e?o.addClass("full-img"):o.removeClass("full-img")}function e(){i.each(o)}var t=$(".post-content");t.fitVids();var i=$(".single-post-inner img").on("load",o);e()},urlIconlize:function(o){var e,t,i={twitter:"icon-twitter",qzone:"icon-qzone",weibo:"icon-weibo",facebook:"icon-facebook",github:"icon-github",douban:"icon-douban",google:"icon-google",luolei:"icon-luolei",dribble:"icon-dribble"};for(var n in i)if("function"!=typeof i[n]){var a=n;o.indexOf(a)>=0&&(e=a,t=i[a])}return t},addIcons:function(){$(".single-post-inner p a:not(:has(img))").each(function(){var o=$(this).attr("href"),e=document.createElement("a");e.href=o,_selfDomain=e.hostname,General.urlIconlize(_selfDomain),console.log(_selfDomain),$(this).prepend('<i class="iconfont '+General.urlIconlize(_selfDomain)+'"></i>');var t=$(this).find("i").css("color"),i=$(this).css("color");$(this).hover(function(){$(this).css("color",t),$(this).addClass("animated pulse")},function(){$(this).css("color",i),$(this).removeClass("animated pulse")})})},scrollToPos:function(o){var e="我要飞到最高",t=o||$(window).height(),i=$('<a href="#" id="to-top" title="'+e+'"> <div class="to-top-wrap"></div></a>').appendTo("body");$(window).scroll(function(){$(window).scrollTop()>$(window).height()?i.fadeIn(500):i.fadeOut(500)}),i.click(function(o){o.preventDefault(),$("html,body").animate({scrollTop:t-50},1e3,function(){window.location.hash="#"}),console.log("我跳")})},resize:function(){visualContainerWidh=$(window).width()}};$(document).ready(function(){General.init(),General.updateImageWidth(),Duoshuo.init(),$(".single-post-inner p:has(img)").each(function(){var o=$(this);o.addClass("with-img"),1==o.isOnScreenVisible()&&o.addClass("with-img").addClass("already-visible")}),$(".post-in-list").each(function(){var o=$(this);1==o.isOnScreenVisible()&&o.addClass("already-visible")}),$(".share h4").on("click",function(){$(".share-icons").css("display","block").addClass("fadeInUpBig animated"),$(this).fadeOut(500)}),$("#header").click(function(){return console.log("下滑"),$("html,body").animate({scrollTop:$(window).height()-20},1e3,function(){}),!1}),$("body").hasClass("post-template")&&($('img[alt="cover"]').addClass("cover-image"),General.addIcons()),($("body").hasClass("archive-template")||$("body").hasClass("home-template"))&&$(".post-excerpt").each(function(){var o=$(this);0==o.has("img").length?(console.log("没有图片"),o.append('<img src="https://luoleiorg.b0.upaiyun.com/tmp/nev-set.jpg"></img>')):console.log("With")}),$(window).scroll(function(){$(window).scrollTop()>50,0==$(".share-icons").isOnScreenVisible()&&($(".share-icons").removeClass("fadeInUpBig animated").css("display","none"),$(".share h4").css("display","block")),($("body").hasClass("archive-template")||$("body").hasClass("home-template"))&&$(".post-in-list").each(function(){var o=$(this);1==o.isOnScreenVisible()&&1!=o.hasClass("already-visible")&&o.addClass("fadeInUpBig animated")})})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UuanMiXSwibmFtZXMiOlsiJCIsImZuIiwiZXh0ZW5kIiwiaXNPblNjcmVlblZpc2libGUiLCJ3aW4iLCJ3aW5kb3ciLCJ2aWV3cG9ydCIsInRvcCIsInNjcm9sbFRvcCIsImxlZnQiLCJzY3JvbGxMZWZ0IiwicmlnaHQiLCJ3aWR0aCIsImJvdHRvbSIsImhlaWdodCIsImJvdW5kcyIsInRoaXMiLCJvZmZzZXQiLCJvdXRlcldpZHRoIiwib3V0ZXJIZWlnaHQiLCJEdW9zaHVvIiwiZGF0YVRocmVhZEtleSIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJob3N0IiwicGF0aG5hbWUiLCJpbml0IiwidG9nZ2xlQm94Iiwib24iLCJoYXMiLCJsZW5ndGgiLCJlbXB0eSIsImVsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiaHJlZiIsIkRVT1NIVU8iLCJFbWJlZFRocmVhZCIsImFwcGVuZCIsInNldFRpbWVvdXQiLCJhZGRDbGFzcyIsImZhZGVPdXQiLCJHZW5lcmFsIiwic2Nyb2xsVG9Qb3MiLCJjaGVja0tleSIsInVwZGF0ZUltYWdlV2lkdGgiLCJlIiwiZXZlbnQiLCJrZXlDb2RlIiwiY29uc29sZSIsImxvZyIsInN0b3AiLCJhbmltYXRlIiwiJHRoaXMiLCJjb250ZW50V2lkdGgiLCIkcG9zdENvbnRlbnQiLCJpbWFnZVdpZHRoIiwibmF0dXJhbFdpZHRoIiwicmVtb3ZlQ2xhc3MiLCJjYXNwZXJGdWxsSW1nIiwiJGltZyIsImVhY2giLCJmaXRWaWRzIiwidXJsSWNvbmxpemUiLCJ1cmwiLCJkb21haW4iLCJfb3V0cHV0IiwiaWNvbk1hcCIsInR3aXR0ZXIiLCJxem9uZSIsIndlaWJvIiwiZmFjZWJvb2siLCJnaXRodWIiLCJkb3ViYW4iLCJnb29nbGUiLCJsdW9sZWkiLCJkcmliYmxlIiwibmFtZSIsIk1hcEtleSIsImluZGV4T2YiLCJhZGRJY29ucyIsIl9zcmMiLCJhdHRyIiwidG1wIiwiX3NlbGZEb21haW4iLCJob3N0bmFtZSIsInByZXBlbmQiLCJfc2VsZkNvbG9yIiwiZmluZCIsImNzcyIsIl9vcmlnaW5hbENvbG9yIiwiaG92ZXIiLCJwb3NpdGlvbiIsIlNUUl9UT19UT1AiLCJjb3ZlckhlaWdodCIsImJ1dHRvbiIsImFwcGVuZFRvIiwic2Nyb2xsIiwiZmFkZUluIiwiY2xpY2siLCJwcmV2ZW50RGVmYXVsdCIsImhhc2giLCJyZXNpemUiLCJ2aXN1YWxDb250YWluZXJXaWRoIiwicmVhZHkiLCJfdGhpcyIsImhhc0NsYXNzIl0sIm1hcHBpbmdzIjoiQUFBQUEsRUFBRUMsR0FBR0MsUUFDREMsa0JBQW1CLFdBQ2YsR0FBSUMsR0FBTUosRUFBRUssUUFDUkMsR0FDQUMsSUFBS0gsRUFBSUksWUFDVEMsS0FBTUwsRUFBSU0sYUFFZEosR0FBU0ssTUFBUUwsRUFBU0csS0FBT0wsRUFBSVEsUUFDckNOLEVBQVNPLE9BQVNQLEVBQVNDLElBQU1ILEVBQUlVLFFBRXJDLElBQUlDLEdBQVNDLEtBQUtDLFFBSWxCLE9BSEFGLEdBQU9KLE1BQVFJLEVBQU9OLEtBQU9PLEtBQUtFLGFBQ2xDSCxFQUFPRixPQUFTRSxFQUFPUixJQUFNUyxLQUFLRyxnQkFFeEJiLEVBQVNLLE1BQVFJLEVBQU9OLE1BQVFILEVBQVNHLEtBQU9NLEVBQU9KLE9BQVNMLEVBQVNPLE9BQVNFLEVBQU9SLEtBQU9ELEVBQVNDLElBQU1RLEVBQU9GLFVBS3hJLElBQUlPLFVBRUFDLGNBQWVDLFNBQVNDLFNBQVcsS0FBT0QsU0FBU0UsS0FBT0YsU0FBU0csU0FFbkVDLEtBQU0sV0FDRk4sUUFBUU8sYUFHWkEsVUFBVyxXQUVQM0IsRUFBRSxtQkFBbUI0QixHQUFHLFFBQVMsV0FFN0IsR0FBSTVCLEVBQUUsaUJBQWlCNkIsSUFBSSxPQUFPQyxPQUFTLEVBRXZDLFdBREE5QixHQUFFLGlCQUFpQitCLE9BR3ZCLElBQUlDLEdBQUtDLFNBQVNDLGNBQWMsTUFDaENGLEdBQUdHLGFBQWEsa0JBQW1CZixRQUFRQyxlQUMzQ1csRUFBR0csYUFBYSxXQUFZYixTQUFTYyxNQUNyQ0MsUUFBUUMsWUFBWU4sR0FDcEJoQyxFQUFFLGlCQUFpQnVDLE9BQU9QLEdBRTFCUSxXQUFXLFdBQ1B4QyxFQUFFLGlCQUFpQnlDLFNBQVMsY0FDN0IsS0FHSEQsV0FBVyxXQUN1QyxHQUExQ3hDLEVBQUUsaUJBQWlCRyxxQkFDbkJILEVBQUUsbUJBQW1CeUMsU0FBUyxvQkFBb0JDLFFBQVEsTUFFL0QsU0FZWEMsU0FDQWpCLEtBQU0sV0FDRmlCLFFBQVFDLGNBQ1JELFFBQVFFLFdBQ1JGLFFBQVFHLG9CQUlaRCxTQUFVLFNBQVNFLEdBQ2ZBLEVBQUlBLEdBQUsxQyxPQUFPMkMsTUFDQyxNQUFiRCxFQUFFRSxTQUNGQyxRQUFRQyxJQUFJLFFBQ1puRCxFQUFFLGFBQWFvRCxPQUNmcEQsRUFBRSxhQUFhcUQsU0FDWDdDLFVBQVdSLEVBQUVLLFFBQVErQyxPQUFPNUMsWUFBYyxLQUMzQyxTQUNpQixNQUFidUMsRUFBRUUsVUFDVGpELEVBQUUsYUFBYW9ELE9BQ2ZwRCxFQUFFLGFBQWFxRCxTQUNYN0MsVUFBV1IsRUFBRUssUUFBUStDLE9BQU81QyxZQUFjLEtBQzNDLFVBSVhzQyxpQkFBa0IsV0FJZCxRQUFTQSxLQUNMLEdBQUlRLEdBQVF0RCxFQUFFZ0IsTUFDVnVDLEVBQWVDLEVBQWF0QyxhQUM1QnVDLEVBQWF6QyxLQUFLMEMsWUFFbEJELElBQWNGLEVBQ2RELEVBQU1iLFNBQVMsWUFFZmEsRUFBTUssWUFBWSxZQU0xQixRQUFTQyxLQUNMQyxFQUFLQyxLQUFLaEIsR0FsQmQsR0FBSVUsR0FBZXhELEVBQUUsZ0JBQ3JCd0QsR0FBYU8sU0FjYixJQUFJRixHQUFPN0QsRUFBRSwwQkFBMEI0QixHQUFHLE9BQVFrQixFQU1sRGMsTUFJSkksWUFBYSxTQUFTQyxHQUNsQixHQUFJQyxHQUNBQyxFQUNBQyxHQUNBQyxRQUFXLGVBQ1hDLE1BQVMsYUFDVEMsTUFBUyxhQUNUQyxTQUFZLGdCQUNaQyxPQUFVLGNBQ1ZDLE9BQVUsY0FDVkMsT0FBVSxjQUNWQyxPQUFVLGNBQ1ZDLFFBQVcsZUFJZixLQUFLLEdBQUlDLEtBQVFWLEdBQ2IsR0FBNkIsa0JBQWxCQSxHQUFRVSxHQUFzQixDQUNyQyxHQUFJQyxHQUFTRCxDQUNUYixHQUFJZSxRQUFRRCxJQUFXLElBQ3ZCYixFQUFTYSxFQUNUWixFQUFVQyxFQUFRVyxJQUs5QixNQUFPWixJQUdYYyxTQUFVLFdBRU5qRixFQUFFLHlDQUF5QzhELEtBQUssV0FDNUMsR0FBSW9CLEdBQU9sRixFQUFFZ0IsTUFBTW1FLEtBQUssUUFDcEJDLEVBQU1uRCxTQUFTQyxjQUFjLElBQ2pDa0QsR0FBSWhELEtBQU84QyxFQUNYRyxZQUFjRCxFQUFJRSxTQUNsQjNDLFFBQVFxQixZQUFZcUIsYUFDcEJuQyxRQUFRQyxJQUFJa0MsYUFFWnJGLEVBQUVnQixNQUFNdUUsUUFBUSxzQkFBd0I1QyxRQUFRcUIsWUFBWXFCLGFBQWUsU0FDM0UsSUFBSUcsR0FBYXhGLEVBQUVnQixNQUFNeUUsS0FBSyxLQUFLQyxJQUFJLFNBQ25DQyxFQUFpQjNGLEVBQUVnQixNQUFNMEUsSUFBSSxRQUdqQzFGLEdBQUVnQixNQUFNNEUsTUFBTSxXQUNWNUYsRUFBRWdCLE1BQU0wRSxJQUFJLFFBQVNGLEdBQ3JCeEYsRUFBRWdCLE1BQU15QixTQUFTLG1CQUNsQixXQUNDekMsRUFBRWdCLE1BQU0wRSxJQUFJLFFBQVNDLEdBQ3JCM0YsRUFBRWdCLE1BQU0yQyxZQUFZLHVCQU9oQ2YsWUFBYSxTQUFTaUQsR0FDbEIsR0FBSUMsR0FBYSxTQUNiQyxFQUFjRixHQUFZN0YsRUFBRUssUUFBUVMsU0FDcENrRixFQUFTaEcsRUFBRSxrQ0FBb0M4RixFQUFhLDBDQUEwQ0csU0FBUyxPQUNuSGpHLEdBQUVLLFFBQVE2RixPQUFPLFdBQ1RsRyxFQUFFSyxRQUFRRyxZQUFjUixFQUFFSyxRQUFRUyxTQUNsQ2tGLEVBQU9HLE9BQU8sS0FFZEgsRUFBT3RELFFBQVEsT0FJdkJzRCxFQUFPSSxNQUFNLFNBQVNyRCxHQUNsQkEsRUFBRXNELGlCQUNGckcsRUFBRSxhQUFhcUQsU0FDWDdDLFVBQVd1RixFQUFjLElBQzFCLElBQU0sV0FDTDFGLE9BQU9pQixTQUFTZ0YsS0FBTyxNQUUzQnBELFFBQVFDLElBQUksU0FJcEJvRCxPQUFRLFdBQ0pDLG9CQUFzQnhHLEVBQUVLLFFBQVFPLFNBYXhDWixHQUFFaUMsVUFBVXdFLE1BQU0sV0FDZDlELFFBQVFqQixPQUNSaUIsUUFBUUcsbUJBRVIxQixRQUFRTSxPQUlSMUIsRUFBRSxpQ0FBaUM4RCxLQUFLLFdBQ3BDLEdBQUk0QyxHQUFRMUcsRUFBRWdCLEtBQ2QwRixHQUFNakUsU0FBUyxZQUVrQixHQUE3QmlFLEVBQU12RyxxQkFDTnVHLEVBQU1qRSxTQUFTLFlBQVlBLFNBQVMscUJBUzVDekMsRUFBRSxpQkFBaUI4RCxLQUFLLFdBQ3BCLEdBQUk0QyxHQUFRMUcsRUFBRWdCLEtBQ21CLElBQTdCMEYsRUFBTXZHLHFCQUNOdUcsRUFBTWpFLFNBQVMscUJBR3ZCekMsRUFBRSxhQUFhNEIsR0FBRyxRQUFTLFdBQ3ZCNUIsRUFBRSxnQkFBZ0IwRixJQUFJLFVBQVcsU0FBU2pELFNBQVMsd0JBQ25EekMsRUFBRWdCLE1BQU0wQixRQUFRLE9BYXBCMUMsRUFBRSxXQUFXb0csTUFBTSxXQU9mLE1BTkFsRCxTQUFRQyxJQUFJLE1BQ1puRCxFQUFFLGFBQWFxRCxTQUNYN0MsVUFBV1IsRUFBRUssUUFBUVMsU0FBVyxJQUNqQyxJQUFNLGVBR0YsSUFJUGQsRUFBRSxRQUFRMkcsU0FBUyxtQkFFbkIzRyxFQUFFLG9CQUFvQnlDLFNBQVMsZUFDL0JFLFFBQVFzQyxhQUdKakYsRUFBRSxRQUFRMkcsU0FBUyxxQkFBdUIzRyxFQUFFLFFBQVEyRyxTQUFTLG1CQUNyRTNHLEVBQUUsaUJBQWlCOEQsS0FBSyxXQUNwQixHQUFJNEMsR0FBUTFHLEVBQUVnQixLQUNnQixJQUEzQjBGLEVBQU03RSxJQUFJLE9BQU9DLFFBQ2hCb0IsUUFBUUMsSUFBSSxRQUNadUQsRUFBTW5FLE9BQU8sdUVBRWJXLFFBQVFDLElBQUksVUFRcEJuRCxFQUFFSyxRQUFRNkYsT0FBTyxXQUVUbEcsRUFBRUssUUFBUUcsWUFBYyxHQUlpQixHQUF6Q1IsRUFBRSxnQkFBZ0JHLHNCQUNsQkgsRUFBRSxnQkFBZ0IyRCxZQUFZLHdCQUF3QitCLElBQUksVUFBVyxRQUNyRTFGLEVBQUUsYUFBYTBGLElBQUksVUFBVyxXQUc5QjFGLEVBQUUsUUFBUTJHLFNBQVMscUJBQXVCM0csRUFBRSxRQUFRMkcsU0FBUyxtQkFDN0QzRyxFQUFFLGlCQUFpQjhELEtBQUssV0FDcEIsR0FBSTRDLEdBQVExRyxFQUFFZ0IsS0FDbUIsSUFBN0IwRixFQUFNdkcscUJBQW9FLEdBQXJDdUcsRUFBTUMsU0FBUyxvQkFDcERELEVBQU1qRSxTQUFTIiwiZmlsZSI6ImFsbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkLmZuLmV4dGVuZCh7XG4gICAgaXNPblNjcmVlblZpc2libGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgd2luID0gJCh3aW5kb3cpO1xuICAgICAgICB2YXIgdmlld3BvcnQgPSB7XG4gICAgICAgICAgICB0b3A6IHdpbi5zY3JvbGxUb3AoKSxcbiAgICAgICAgICAgIGxlZnQ6IHdpbi5zY3JvbGxMZWZ0KClcbiAgICAgICAgfTtcbiAgICAgICAgdmlld3BvcnQucmlnaHQgPSB2aWV3cG9ydC5sZWZ0ICsgd2luLndpZHRoKCk7XG4gICAgICAgIHZpZXdwb3J0LmJvdHRvbSA9IHZpZXdwb3J0LnRvcCArIHdpbi5oZWlnaHQoKTtcblxuICAgICAgICB2YXIgYm91bmRzID0gdGhpcy5vZmZzZXQoKTtcbiAgICAgICAgYm91bmRzLnJpZ2h0ID0gYm91bmRzLmxlZnQgKyB0aGlzLm91dGVyV2lkdGgoKTtcbiAgICAgICAgYm91bmRzLmJvdHRvbSA9IGJvdW5kcy50b3AgKyB0aGlzLm91dGVySGVpZ2h0KCk7XG5cbiAgICAgICAgcmV0dXJuICghKHZpZXdwb3J0LnJpZ2h0IDwgYm91bmRzLmxlZnQgfHwgdmlld3BvcnQubGVmdCA+IGJvdW5kcy5yaWdodCB8fCB2aWV3cG9ydC5ib3R0b20gPCBib3VuZHMudG9wIHx8IHZpZXdwb3J0LnRvcCA+IGJvdW5kcy5ib3R0b20pKTtcbiAgICB9XG59KTtcblxuXG52YXIgRHVvc2h1byA9IHtcblxuICAgIGRhdGFUaHJlYWRLZXk6IGxvY2F0aW9uLnByb3RvY29sICsgJy8vJyArIGxvY2F0aW9uLmhvc3QgKyBsb2NhdGlvbi5wYXRobmFtZSxcblxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBEdW9zaHVvLnRvZ2dsZUJveCgpO1xuICAgIH0sXG5cbiAgICB0b2dnbGVCb3g6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQoJy50b2dnbGUtY29tbWVudCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ+W8gOWQr+ivhOiuuicpO1xuICAgICAgICAgICAgaWYgKCQoJy5jb21tZW50LWFyZWEnKS5oYXMoJ2RpdicpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAkKCcuY29tbWVudC1hcmVhJykuZW1wdHkoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS10aHJlYWQta2V5JywgRHVvc2h1by5kYXRhVGhyZWFkS2V5KTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS11cmwnLCBsb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgICAgIERVT1NIVU8uRW1iZWRUaHJlYWQoZWwpO1xuICAgICAgICAgICAgJCgnLmNvbW1lbnQtYXJlYScpLmFwcGVuZChlbCk7XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJCgnLmNvbW1lbnQtYXJlYScpLmFkZENsYXNzKCd0b2dnbGUtdXAnKTtcbiAgICAgICAgICAgIH0sIDUwMClcblxuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICgkKCcuY29tbWVudC1hcmVhJykuaXNPblNjcmVlblZpc2libGUoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy50b2dnbGUtY29tbWVudCcpLmFkZENsYXNzKCdhbmltYXRlZCBmYWRlT3V0JykuZmFkZU91dCg1MDApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwMClcblxuXG5cbiAgICAgICAgfSlcblxuICAgIH1cbn1cblxuXG5cblxudmFyIEdlbmVyYWwgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIEdlbmVyYWwuc2Nyb2xsVG9Qb3MoKTtcbiAgICAgICAgR2VuZXJhbC5jaGVja0tleSgpO1xuICAgICAgICBHZW5lcmFsLnVwZGF0ZUltYWdlV2lkdGgoKTtcbiAgICB9LFxuXG4gICAgLy/mqKHmi5/pvKDmoIfkuIrkuIvmu5rliqhcbiAgICBjaGVja0tleTogZnVuY3Rpb24oZSkge1xuICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gJzc0Jykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+aMieS4i+mUruebmCcpO1xuICAgICAgICAgICAgJCgnaHRtbCxib2R5Jykuc3RvcCgpO1xuICAgICAgICAgICAgJCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKHdpbmRvdykuc3RvcCgpLnNjcm9sbFRvcCgpICsgMjAwXG4gICAgICAgICAgICB9LCAnZmFzdCcpXG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09ICc3NScpIHtcbiAgICAgICAgICAgICQoJ2h0bWwsYm9keScpLnN0b3AoKTtcbiAgICAgICAgICAgICQoJ2h0bWwsYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogJCh3aW5kb3cpLnN0b3AoKS5zY3JvbGxUb3AoKSAtIDIwMFxuICAgICAgICAgICAgfSwgJ2Zhc3QnKVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHVwZGF0ZUltYWdlV2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJHBvc3RDb250ZW50ID0gJChcIi5wb3N0LWNvbnRlbnRcIik7XG4gICAgICAgICRwb3N0Q29udGVudC5maXRWaWRzKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlSW1hZ2VXaWR0aCgpIHtcbiAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgY29udGVudFdpZHRoID0gJHBvc3RDb250ZW50Lm91dGVyV2lkdGgoKSwgLy8gV2lkdGggb2YgdGhlIGNvbnRlbnRcbiAgICAgICAgICAgICAgICBpbWFnZVdpZHRoID0gdGhpcy5uYXR1cmFsV2lkdGg7IC8vIE9yaWdpbmFsIGltYWdlIHJlc29sdXRpb25cblxuICAgICAgICAgICAgaWYgKGltYWdlV2lkdGggPj0gY29udGVudFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3MoJ2Z1bGwtaW1nJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKCdmdWxsLWltZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyICRpbWcgPSAkKFwiLnNpbmdsZS1wb3N0LWlubmVyIGltZ1wiKS5vbignbG9hZCcsIHVwZGF0ZUltYWdlV2lkdGgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNhc3BlckZ1bGxJbWcoKSB7XG4gICAgICAgICAgICAkaW1nLmVhY2godXBkYXRlSW1hZ2VXaWR0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBjYXNwZXJGdWxsSW1nKCk7XG4gICAgfSxcblxuICAgIC8q57uZ5paH56ug5Lit55qEdXJs5re75YqgaWNvbmZvbnTmlrnkvr/or4bliKsqL1xuICAgIHVybEljb25saXplOiBmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgdmFyIGRvbWFpbixcbiAgICAgICAgICAgIF9vdXRwdXQ7XG4gICAgICAgIHZhciBpY29uTWFwID0geyAvKue0ouW8lSDlj6/lnKjov5nph4zmt7vliqDljLnphY3op4TliJkqL1xuICAgICAgICAgICAgJ3R3aXR0ZXInOiAnaWNvbi10d2l0dGVyJyxcbiAgICAgICAgICAgICdxem9uZSc6ICdpY29uLXF6b25lJyxcbiAgICAgICAgICAgICd3ZWlibyc6ICdpY29uLXdlaWJvJyxcbiAgICAgICAgICAgICdmYWNlYm9vayc6ICdpY29uLWZhY2Vib29rJyxcbiAgICAgICAgICAgICdnaXRodWInOiAnaWNvbi1naXRodWInLFxuICAgICAgICAgICAgJ2RvdWJhbic6ICdpY29uLWRvdWJhbicsXG4gICAgICAgICAgICAnZ29vZ2xlJzogJ2ljb24tZ29vZ2xlJyxcbiAgICAgICAgICAgICdsdW9sZWknOiAnaWNvbi1sdW9sZWknLFxuICAgICAgICAgICAgJ2RyaWJibGUnOiAnaWNvbi1kcmliYmxlJ1xuXG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBuYW1lIGluIGljb25NYXApIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaWNvbk1hcFtuYW1lXSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHZhciBNYXBLZXkgPSBuYW1lO1xuICAgICAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZihNYXBLZXkpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tYWluID0gTWFwS2V5O1xuICAgICAgICAgICAgICAgICAgICBfb3V0cHV0ID0gaWNvbk1hcFtNYXBLZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBfb3V0cHV0O1xuICAgIH0sXG5cbiAgICBhZGRJY29uczogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8q57uZ5Y2a5a6i5paH56ug5Zyw5Z2AdXJs5re75YqgaWNv6K+G5YirKi9cbiAgICAgICAgJCgnLnNpbmdsZS1wb3N0LWlubmVyIHAgYTpub3QoOmhhcyhpbWcpKScpLmVhY2goZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgdmFyIF9zcmMgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgIHZhciB0bXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICB0bXAuaHJlZiA9IF9zcmM7XG4gICAgICAgICAgICBfc2VsZkRvbWFpbiA9IHRtcC5ob3N0bmFtZTtcbiAgICAgICAgICAgIEdlbmVyYWwudXJsSWNvbmxpemUoX3NlbGZEb21haW4pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coX3NlbGZEb21haW4pO1xuICAgICAgICAgICAgLy8kKHRoaXMpLmFwcGVuZCh1cmxJY29ubGl6ZShfc2VsZkRvbWFpbikpO1xuICAgICAgICAgICAgJCh0aGlzKS5wcmVwZW5kKCc8aSBjbGFzcz1cImljb25mb250ICcgKyBHZW5lcmFsLnVybEljb25saXplKF9zZWxmRG9tYWluKSArICdcIj48L2k+Jyk7XG4gICAgICAgICAgICB2YXIgX3NlbGZDb2xvciA9ICQodGhpcykuZmluZCgnaScpLmNzcygnY29sb3InKSxcbiAgICAgICAgICAgICAgICBfb3JpZ2luYWxDb2xvciA9ICQodGhpcykuY3NzKCdjb2xvcicpO1xuXG4gICAgICAgICAgICAvKum8oOagh+aCrOa1ruaXtiovXG4gICAgICAgICAgICAkKHRoaXMpLmhvdmVyKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdjb2xvcicsIF9zZWxmQ29sb3IpO1xuICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FuaW1hdGVkIHB1bHNlJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcygnY29sb3InLCBfb3JpZ2luYWxDb2xvcik7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYW5pbWF0ZWQgcHVsc2UnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvL+W5s+a7kea7muWKqOWIsOmhtumDqFxuICAgIHNjcm9sbFRvUG9zOiBmdW5jdGlvbihwb3NpdGlvbikge1xuICAgICAgICB2YXIgU1RSX1RPX1RPUCA9ICfmiJHopoHpo57liLDmnIDpq5gnLFxuICAgICAgICAgICAgY292ZXJIZWlnaHQgPSBwb3NpdGlvbiB8fCAkKHdpbmRvdykuaGVpZ2h0KCk7IC8v6I635b6X5Zu+54mH6auY5bqmXG4gICAgICAgIHZhciBidXR0b24gPSAkKCc8YSBocmVmPVwiI1wiIGlkPVwidG8tdG9wXCIgdGl0bGU9XCInICsgU1RSX1RPX1RPUCArICdcIj4gPGRpdiBjbGFzcz1cInRvLXRvcC13cmFwXCI+PC9kaXY+PC9hPicpLmFwcGVuZFRvKCdib2R5Jyk7XG4gICAgICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gJCh3aW5kb3cpLmhlaWdodCgpKSB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmZhZGVJbig1MDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBidXR0b24uZmFkZU91dCg1MDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBidXR0b24uY2xpY2soZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgJCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiBjb3ZlckhlaWdodCAtIDUwXG4gICAgICAgICAgICB9LCAxMDAwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICcjJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+aIkei3sycpO1xuICAgICAgICB9KVxuICAgIH0sXG4gICAgLy/lpITnkIblsY/luZXlj5jljJbml7ZcbiAgICByZXNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2aXN1YWxDb250YWluZXJXaWRoID0gJCh3aW5kb3cpLndpZHRoKCk7XG4gICAgICAgIC8vIGNvbnRlbnRXaWR0aD0kKCcucG9zdC1jb250ZW50Jykud2lkdGgoKTtcbiAgICAgICAgLy8gJCgnLnNpbmdsZS1wb3N0LWlubmVyIGltZycpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICB2YXIgX2ltZyA9ICQodGhpcyk7XG4gICAgICAgIC8vICAgICBjaGVja0ltZyhfaW1nKTtcbiAgICAgICAgLy8gfSlcbiAgICB9XG5cblxuXG59XG5cblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgR2VuZXJhbC5pbml0KCk7XG4gICAgR2VuZXJhbC51cGRhdGVJbWFnZVdpZHRoKCk7XG4gICAgLy8g5Yqg6L295aSa6K+06K+E6K66XG4gICAgRHVvc2h1by5pbml0KCk7XG5cblxuXG4gICAgJCgnLnNpbmdsZS1wb3N0LWlubmVyIHA6aGFzKGltZyknKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xuICAgICAgICBfdGhpcy5hZGRDbGFzcygnd2l0aC1pbWcnKTtcblxuICAgICAgICBpZiAoX3RoaXMuaXNPblNjcmVlblZpc2libGUoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICBfdGhpcy5hZGRDbGFzcygnd2l0aC1pbWcnKS5hZGRDbGFzcygnYWxyZWFkeS12aXNpYmxlJyk7XG4gICAgICAgIH1cblxuICAgIH0pXG5cblxuXG5cblxuICAgICQoJy5wb3N0LWluLWxpc3QnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xuICAgICAgICBpZiAoX3RoaXMuaXNPblNjcmVlblZpc2libGUoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICBfdGhpcy5hZGRDbGFzcygnYWxyZWFkeS12aXNpYmxlJylcbiAgICAgICAgfVxuICAgIH0pXG4gICAgJCgnLnNoYXJlIGg0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICQoJy5zaGFyZS1pY29ucycpLmNzcygnZGlzcGxheScsICdibG9jaycpLmFkZENsYXNzKCdmYWRlSW5VcEJpZyBhbmltYXRlZCcpXG4gICAgICAgICQodGhpcykuZmFkZU91dCg1MDApO1xuXG4gICAgICAgIC8vIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICAkKCdodG1sLGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgLy8gICAgICAgICBzY3JvbGxUb3A6ICQoJyNzaGFyZS1pY29ucycpLm9mZnNldCgpLnRvcCAtICQod2luZG93KS5oZWlnaHQoKSAvIDJcbiAgICAgICAgLy8gICAgIH0sIDEwMDAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyAgICAgICAgIC8vIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJyMnO1xuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgIC8vIH0sIDEwMDApXG5cblxuICAgIH0pXG5cbiAgICAkKCcjaGVhZGVyJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfkuIvmu5EnKTtcbiAgICAgICAgJCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgICBzY3JvbGxUb3A6ICQod2luZG93KS5oZWlnaHQoKSAtIDIwXG4gICAgICAgIH0sIDEwMDAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gd2luZG93LmxvY2F0aW9uLmhhc2ggPSAnIyc7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSlcblxuXG4gICAgaWYgKCQoJ2JvZHknKS5oYXNDbGFzcygncG9zdC10ZW1wbGF0ZScpKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCflpITnkIblm77moIcnKTtcbiAgICAgICAgJCgnaW1nW2FsdD1cImNvdmVyXCJdJykuYWRkQ2xhc3MoJ2NvdmVyLWltYWdlJyk7XG4gICAgICAgIEdlbmVyYWwuYWRkSWNvbnMoKTtcbiAgICB9XG5cbiAgICAgICAgaWYgKCQoJ2JvZHknKS5oYXNDbGFzcygnYXJjaGl2ZS10ZW1wbGF0ZScpIHx8ICQoJ2JvZHknKS5oYXNDbGFzcygnaG9tZS10ZW1wbGF0ZScpKSB7XG4gICAgJCgnLnBvc3QtZXhjZXJwdCcpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcbiAgICAgICAgaWYoX3RoaXMuaGFzKCdpbWcnKS5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn5rKh5pyJ5Zu+54mHJyk7XG4gICAgICAgICAgICBfdGhpcy5hcHBlbmQoJzxpbWcgc3JjPVwiaHR0cHM6Ly9sdW9sZWlvcmcuYjAudXBhaXl1bi5jb20vdG1wL25ldi1zZXQuanBnXCI+PC9pbWc+JylcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnV2l0aCcpO1xuICAgICAgICB9XG4gICAgfSlcbiAgICAgICAgfVxuXG5cblxuXG4gICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbigpIHtcblxuICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gNTApIHtcbiAgICAgICAgICAgIC8vICQoJy5uYXYtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKS5hZGRDbGFzcygnZmFkZUluRG93bkJpZyBhbmltYXRlZCcpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJCgnLnNoYXJlLWljb25zJykuaXNPblNjcmVlblZpc2libGUoKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgJCgnLnNoYXJlLWljb25zJykucmVtb3ZlQ2xhc3MoJ2ZhZGVJblVwQmlnIGFuaW1hdGVkJykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKVxuICAgICAgICAgICAgJCgnLnNoYXJlIGg0JykuY3NzKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJCgnYm9keScpLmhhc0NsYXNzKCdhcmNoaXZlLXRlbXBsYXRlJykgfHwgJCgnYm9keScpLmhhc0NsYXNzKCdob21lLXRlbXBsYXRlJykpIHtcbiAgICAgICAgICAgICQoJy5wb3N0LWluLWxpc3QnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzT25TY3JlZW5WaXNpYmxlKCkgPT0gdHJ1ZSAmJiBfdGhpcy5oYXNDbGFzcygnYWxyZWFkeS12aXNpYmxlJykgIT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5hZGRDbGFzcygnZmFkZUluVXBCaWcgYW5pbWF0ZWQnKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICAvLyAkKCcuc2luZ2xlLXBvc3QtaW5uZXIgcDpoYXMoaW1nKScpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xuICAgICAgICAvLyAgICAgaWYgKF90aGlzLmlzT25TY3JlZW5WaXNpYmxlKCkgPT0gdHJ1ZSAmJiBfdGhpcy5oYXNDbGFzcygnYWxyZWFkeS12aXNpYmxlJykgIT0gdHJ1ZSkge1xuICAgICAgICAvLyAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICAgICAgICAgIF90aGlzLmFkZENsYXNzKCd3aXRoLWltZycpO1xuICAgICAgICAvLyAgICAgICAgIH0sIDIwMClcblxuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9KVxuXG5cblxuICAgIH0pXG5cbn0pXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=