$.fn.extend({isOnScreenVisible:function(){var e=$(window),t={top:e.scrollTop(),left:e.scrollLeft()};t.right=t.left+e.width(),t.bottom=t.top+e.height();var a=this.offset();return a.right=a.left+this.outerWidth(),a.bottom=a.top+this.outerHeight(),!(t.right<a.left||t.left>a.right||t.bottom<a.top||t.top>a.bottom)}});var scrollme=function(e){var t={},a=e(document),o=e(window);return t.body_height=0,t.viewport_height=0,t.viewport_top=0,t.viewport_bottom=0,t.viewport_top_previous=-1,t.elements=[],t.elements_in_view=[],t.property_defaults={opacity:1,translatex:0,translatey:0,translatez:0,rotatex:0,rotatey:0,rotatez:0,scale:1,scalex:1,scaley:1,scalez:1},t.scrollme_selector=".scrollme",t.animateme_selector=".animateme",t.update_interval=10,t.easing_functions={linear:function(e){return e},easeout:function(e){return e*e*e},easein:function(e){return e=1-e,1-e*e*e},easeinout:function(e){return.5>e?4*e*e*e:(e=1-e,1-4*e*e*e)}},t.init_events=["ready","page:load","page:change"],t.init_if=function(){return!0},t.init=function(){return t.init_if()?(t.init_elements(),t.on_resize(),o.on("resize orientationchange",function(){t.on_resize()}),o.load(function(){setTimeout(function(){t.on_resize()},100)}),setInterval(t.update,t.update_interval),!0):!1},t.init_elements=function(){e(t.scrollme_selector).each(function(){var a={};a.element=e(this);var o=[];e(this).find(t.animateme_selector).addBack(t.animateme_selector).each(function(){var a={};a.element=e(this),a.when=a.element.data("when"),a.from=a.element.data("from"),a.to=a.element.data("to"),a.crop=a.element.is("[data-crop]")?a.element.data("crop"):!0,a.easing=a.element.is("[data-easing]")?t.easing_functions[a.element.data("easing")]:t.easing_functions.easeout;var i={};a.element.is("[data-opacity]")&&(i.opacity=a.element.data("opacity")),a.element.is("[data-translatex]")&&(i.translatex=a.element.data("translatex")),a.element.is("[data-translatey]")&&(i.translatey=a.element.data("translatey")),a.element.is("[data-translatez]")&&(i.translatez=a.element.data("translatez")),a.element.is("[data-rotatex]")&&(i.rotatex=a.element.data("rotatex")),a.element.is("[data-rotatey]")&&(i.rotatey=a.element.data("rotatey")),a.element.is("[data-rotatez]")&&(i.rotatez=a.element.data("rotatez")),a.element.is("[data-scale]")&&(i.scale=a.element.data("scale")),a.element.is("[data-scalex]")&&(i.scalex=a.element.data("scalex")),a.element.is("[data-scaley]")&&(i.scaley=a.element.data("scaley")),a.element.is("[data-scalez]")&&(i.scalez=a.element.data("scalez")),a.properties=i,o.push(a)}),a.effects=o,t.elements.push(a)})},t.update=function(){window.requestAnimationFrame(function(){t.update_viewport_position(),t.viewport_top_previous!=t.viewport_top&&(t.update_elements_in_view(),t.animate()),t.viewport_top_previous=t.viewport_top})},t.animate=function(){for(var e=t.elements_in_view.length,a=0;e>a;a++)for(var o=t.elements_in_view[a],i=o.effects.length,n=0;i>n;n++){var s=o.effects[n];switch(s.when){case"view":case"span":var l=o.top-t.viewport_height,r=o.bottom;break;case"exit":var l=o.bottom-t.viewport_height,r=o.bottom;break;default:var l=o.top-t.viewport_height,r=o.top}s.crop&&(0>l&&(l=0),r>t.body_height-t.viewport_height&&(r=t.body_height-t.viewport_height));var c=(t.viewport_top-l)/(r-l),d=s.from,m=s.to,p=m-d,u=(c-d)/p,h=s.easing(u),f=t.animate_value(c,h,d,m,s,"opacity"),v=t.animate_value(c,h,d,m,s,"translatey"),g=t.animate_value(c,h,d,m,s,"translatex"),_=t.animate_value(c,h,d,m,s,"translatez"),w=t.animate_value(c,h,d,m,s,"rotatex"),b=t.animate_value(c,h,d,m,s,"rotatey"),$=t.animate_value(c,h,d,m,s,"rotatez"),y=t.animate_value(c,h,d,m,s,"scale"),x=t.animate_value(c,h,d,m,s,"scalex"),z=t.animate_value(c,h,d,m,s,"scaley"),C=t.animate_value(c,h,d,m,s,"scalez");"scale"in s.properties&&(x=y,z=y,C=y),s.element.css({opacity:f,transform:"translate3d( "+g+"px , "+v+"px , "+_+"px ) rotateX( "+w+"deg ) rotateY( "+b+"deg ) rotateZ( "+$+"deg ) scale3d( "+x+" , "+z+" , "+C+" )","-webkit-transform":"translate3d( "+g+"px , "+v+"px , "+_+"px ) rotateX( "+w+"deg ) rotateY( "+b+"deg ) rotateZ( "+$+"deg ) scale3d( "+x+" , "+z+" , "+C+" )"})}},t.animate_value=function(e,a,o,i,n,s){var l=t.property_defaults[s];if(!(s in n.properties))return l;var r=n.properties[s],c=i>o?!0:!1;if(o>e&&c)return l;if(e>i&&c)return r;if(e>o&&!c)return l;if(i>e&&!c)return r;var d=l+a*(r-l);switch(s){case"opacity":d=d.toFixed(2);break;case"translatex":d=d.toFixed(0);break;case"translatey":d=d.toFixed(0);break;case"translatez":d=d.toFixed(0);break;case"rotatex":d=d.toFixed(1);break;case"rotatey":d=d.toFixed(1);break;case"rotatez":d=d.toFixed(1);break;case"scale":d=d.toFixed(3)}return d},t.update_viewport_position=function(){t.viewport_top=o.scrollTop(),t.viewport_bottom=t.viewport_top+t.viewport_height},t.update_elements_in_view=function(){t.elements_in_view=[];for(var e=t.elements.length,a=0;e>a;a++)t.elements[a].top<t.viewport_bottom&&t.elements[a].bottom>t.viewport_top&&t.elements_in_view.push(t.elements[a])},t.on_resize=function(){t.update_viewport(),t.update_element_heights(),t.update_viewport_position(),t.update_elements_in_view(),t.animate()},t.update_viewport=function(){t.body_height=a.height(),t.viewport_height=o.height()},t.update_element_heights=function(){for(var e=t.elements.length,a=0;e>a;a++){var o=t.elements[a].element.outerHeight(),i=t.elements[a].element.offset();t.elements[a].height=o,t.elements[a].top=i.top,t.elements[a].bottom=i.top+o}},a.on(t.init_events.join(" "),function(){t.init()}),t},Duoshuo={dataThreadKey:location.protocol+"//"+location.host+location.pathname,init:function(){Duoshuo.toggleBox()},toggleBox:function(){$(".toggle-comment").on("click",function(){if($(".comment-area").has("div").length>0)return void $(".comment-area").empty();var e=document.createElement("div");e.setAttribute("data-thread-key",Duoshuo.dataThreadKey),e.setAttribute("data-url",location.href),DUOSHUO.EmbedThread(e),$(".comment-area").append(e),setTimeout(function(){$(".comment-area").addClass("toggle-up")},500),setTimeout(function(){1==$(".comment-area").isOnScreenVisible()&&$(".toggle-comment").addClass("animated fadeOut").fadeOut(500)},1e3)})}},General={isWeixin:!1,init:function(){General.scrollToPos(),General.checkKey(),General.updateImageWidth();var e=navigator.userAgent.toLowerCase();"micromessenger"==e.match(/MicroMessenger/i)&&(General.isWeixin=!0)},checkKey:function(e){e=e||window.event,"74"==e.keyCode?(console.log("按下键盘"),$("html,body").stop(),$("html,body").animate({scrollTop:$(window).stop().scrollTop()+200},"fast")):"75"==e.keyCode&&($("html,body").stop(),$("html,body").animate({scrollTop:$(window).stop().scrollTop()-200},"fast"))},updateImageWidth:function(){function e(){var e=$(this),t=a.outerWidth(),o=this.naturalWidth;o>=t?e.addClass("full-img"):e.removeClass("full-img")}function t(){o.each(e)}var a=$(".post-content");a.fitVids();var o=$(".single-post-inner img").on("load",e);t()},urlIconlize:function(e){var t,a,o={twitter:"icon-twitter",qzone:"icon-qzone",weibo:"icon-weibo",facebook:"icon-facebook",github:"icon-github",douban:"icon-douban",google:"icon-google",luolei:"icon-luolei",dribble:"icon-dribble"};for(var i in o)if("function"!=typeof o[i]){var n=i;e.indexOf(n)>=0&&(t=n,a=o[n])}return a},addIcons:function(){$(".single-post-inner p a:not(:has(img))").each(function(){var e=$(this).attr("href"),t=document.createElement("a");t.href=e,_selfDomain=t.hostname,General.urlIconlize(_selfDomain),console.log(_selfDomain),$(this).prepend('<i class="iconfont '+General.urlIconlize(_selfDomain)+'"></i>');var a=$(this).find("i").css("color"),o=$(this).css("color");$(this).hover(function(){$(this).css("color",a),$(this).addClass("animated pulse")},function(){$(this).css("color",o),$(this).removeClass("animated pulse")})})},scrollToPos:function(e){var t="我要飞到最高",a=e||$(window).height(),o=$('<a href="#" id="to-top" title="'+t+'"> <div class="to-top-wrap"></div></a>').appendTo("body");$(window).scroll(function(){$(window).scrollTop()>$(window).height()?o.fadeIn(500):o.fadeOut(500)}),o.click(function(e){e.preventDefault(),$("html,body").animate({scrollTop:a-50},1e3,function(){window.location.hash="#"}),console.log("我跳")})},resize:function(){visualContainerWidh=$(window).width()}};$(document).ready(function(){General.init(),0==General.isWeixin&&scrollme($),$("body").hasClass("post-template")&&(General.updateImageWidth(),$('img[alt="cover"]').addClass("cover-image"),General.addIcons(),$(".share h4").on("click",function(){$(".share-icons").css("display","block").addClass("fadeInUpBig animated"),$(this).fadeOut(500)}),Duoshuo.init(),$(".single-post-inner p:has(img)").each(function(){var e=$(this);e.addClass("with-img"),1==e.isOnScreenVisible()&&e.addClass("with-img").addClass("already-visible")})),($("body").hasClass("archive-template")||$("body").hasClass("home-template"))&&($(".post-in-list").each(function(){var e=$(this);1==e.isOnScreenVisible()&&e.addClass("already-visible")}),$(".post-excerpt").each(function(){var e=$(this);0==e.has("img").length?(console.log("没有图片"),e.append('<img src="https://luoleiorg.b0.upaiyun.com/tmp/nev-set.jpg"></img>')):console.log("With")})),$(".arrow_down").click(function(){return $("html,body").animate({scrollTop:$(window).height()-20},1e3,function(){}),!1}),$(window).scroll(function(){$(window).scrollTop()>50,$("body").hasClass("post-template")&&(0==$(".share-icons").isOnScreenVisible()&&($(".share-icons").removeClass("fadeInUpBig animated").css("display","none"),$(".share h4").css("display","block")),1==General.isWeixin&&1==$(".copyright").isOnScreenVisible()&&(console.log("显示了"),$(".wechat-notice").css("display","block").addClass("fadeInUpBig animated"))),($("body").hasClass("archive-template")||$("body").hasClass("home-template"))&&$(".post-in-list").each(function(){var e=$(this);1==e.isOnScreenVisible()&&1!=e.hasClass("already-visible")&&e.addClass("fadeInUpBig animated")})})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UuanMiXSwibmFtZXMiOlsiJCIsImZuIiwiZXh0ZW5kIiwiaXNPblNjcmVlblZpc2libGUiLCJ3aW4iLCJ3aW5kb3ciLCJ2aWV3cG9ydCIsInRvcCIsInNjcm9sbFRvcCIsImxlZnQiLCJzY3JvbGxMZWZ0IiwicmlnaHQiLCJ3aWR0aCIsImJvdHRvbSIsImhlaWdodCIsImJvdW5kcyIsInRoaXMiLCJvZmZzZXQiLCJvdXRlcldpZHRoIiwib3V0ZXJIZWlnaHQiLCJzY3JvbGxtZSIsIl90aGlzIiwiJGRvY3VtZW50IiwiZG9jdW1lbnQiLCIkd2luZG93IiwiYm9keV9oZWlnaHQiLCJ2aWV3cG9ydF9oZWlnaHQiLCJ2aWV3cG9ydF90b3AiLCJ2aWV3cG9ydF9ib3R0b20iLCJ2aWV3cG9ydF90b3BfcHJldmlvdXMiLCJlbGVtZW50cyIsImVsZW1lbnRzX2luX3ZpZXciLCJwcm9wZXJ0eV9kZWZhdWx0cyIsIm9wYWNpdHkiLCJ0cmFuc2xhdGV4IiwidHJhbnNsYXRleSIsInRyYW5zbGF0ZXoiLCJyb3RhdGV4Iiwicm90YXRleSIsInJvdGF0ZXoiLCJzY2FsZSIsInNjYWxleCIsInNjYWxleSIsInNjYWxleiIsInNjcm9sbG1lX3NlbGVjdG9yIiwiYW5pbWF0ZW1lX3NlbGVjdG9yIiwidXBkYXRlX2ludGVydmFsIiwiZWFzaW5nX2Z1bmN0aW9ucyIsImxpbmVhciIsIngiLCJlYXNlb3V0IiwiZWFzZWluIiwiZWFzZWlub3V0IiwiaW5pdF9ldmVudHMiLCJpbml0X2lmIiwiaW5pdCIsImluaXRfZWxlbWVudHMiLCJvbl9yZXNpemUiLCJvbiIsImxvYWQiLCJzZXRUaW1lb3V0Iiwic2V0SW50ZXJ2YWwiLCJ1cGRhdGUiLCJlYWNoIiwiZWxlbWVudCIsImVmZmVjdHMiLCJmaW5kIiwiYWRkQmFjayIsImVmZmVjdCIsIndoZW4iLCJkYXRhIiwiZnJvbSIsInRvIiwiY3JvcCIsImlzIiwiZWFzaW5nIiwicHJvcGVydGllcyIsInB1c2giLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ1cGRhdGVfdmlld3BvcnRfcG9zaXRpb24iLCJ1cGRhdGVfZWxlbWVudHNfaW5fdmlldyIsImFuaW1hdGUiLCJlbGVtZW50c19pbl92aWV3X2xlbmd0aCIsImxlbmd0aCIsImkiLCJlZmZlY3RzX2xlbmd0aCIsImUiLCJzdGFydCIsImVuZCIsInNjcm9sbCIsInNjcm9sbF9yZWxhdGl2ZSIsInNjcm9sbF9lYXNlZCIsImFuaW1hdGVfdmFsdWUiLCJjc3MiLCJ0cmFuc2Zvcm0iLCItd2Via2l0LXRyYW5zZm9ybSIsInByb3BlcnR5IiwidmFsdWVfZGVmYXVsdCIsInZhbHVlX3RhcmdldCIsImZvcndhcmRzIiwibmV3X3ZhbHVlIiwidG9GaXhlZCIsImVsZW1lbnRzX2xlbmd0aCIsInVwZGF0ZV92aWV3cG9ydCIsInVwZGF0ZV9lbGVtZW50X2hlaWdodHMiLCJlbGVtZW50X2hlaWdodCIsInBvc2l0aW9uIiwiam9pbiIsIkR1b3NodW8iLCJkYXRhVGhyZWFkS2V5IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJwYXRobmFtZSIsInRvZ2dsZUJveCIsImhhcyIsImVtcHR5IiwiZWwiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiaHJlZiIsIkRVT1NIVU8iLCJFbWJlZFRocmVhZCIsImFwcGVuZCIsImFkZENsYXNzIiwiZmFkZU91dCIsIkdlbmVyYWwiLCJpc1dlaXhpbiIsInNjcm9sbFRvUG9zIiwiY2hlY2tLZXkiLCJ1cGRhdGVJbWFnZVdpZHRoIiwiVUEiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b0xvd2VyQ2FzZSIsIm1hdGNoIiwiZXZlbnQiLCJrZXlDb2RlIiwiY29uc29sZSIsImxvZyIsInN0b3AiLCIkdGhpcyIsImNvbnRlbnRXaWR0aCIsIiRwb3N0Q29udGVudCIsImltYWdlV2lkdGgiLCJuYXR1cmFsV2lkdGgiLCJyZW1vdmVDbGFzcyIsImNhc3BlckZ1bGxJbWciLCIkaW1nIiwiZml0VmlkcyIsInVybEljb25saXplIiwidXJsIiwiZG9tYWluIiwiX291dHB1dCIsImljb25NYXAiLCJ0d2l0dGVyIiwicXpvbmUiLCJ3ZWlibyIsImZhY2Vib29rIiwiZ2l0aHViIiwiZG91YmFuIiwiZ29vZ2xlIiwibHVvbGVpIiwiZHJpYmJsZSIsIm5hbWUiLCJNYXBLZXkiLCJpbmRleE9mIiwiYWRkSWNvbnMiLCJfc3JjIiwiYXR0ciIsInRtcCIsIl9zZWxmRG9tYWluIiwiaG9zdG5hbWUiLCJwcmVwZW5kIiwiX3NlbGZDb2xvciIsIl9vcmlnaW5hbENvbG9yIiwiaG92ZXIiLCJTVFJfVE9fVE9QIiwiY292ZXJIZWlnaHQiLCJidXR0b24iLCJhcHBlbmRUbyIsImZhZGVJbiIsImNsaWNrIiwicHJldmVudERlZmF1bHQiLCJoYXNoIiwicmVzaXplIiwidmlzdWFsQ29udGFpbmVyV2lkaCIsInJlYWR5IiwiaGFzQ2xhc3MiXSwibWFwcGluZ3MiOiJBQUFBQSxFQUFFQyxHQUFHQyxRQUNEQyxrQkFBbUIsV0FDZixHQUFJQyxHQUFNSixFQUFFSyxRQUNSQyxHQUNBQyxJQUFLSCxFQUFJSSxZQUNUQyxLQUFNTCxFQUFJTSxhQUVkSixHQUFTSyxNQUFRTCxFQUFTRyxLQUFPTCxFQUFJUSxRQUNyQ04sRUFBU08sT0FBU1AsRUFBU0MsSUFBTUgsRUFBSVUsUUFFckMsSUFBSUMsR0FBU0MsS0FBS0MsUUFJbEIsT0FIQUYsR0FBT0osTUFBUUksRUFBT04sS0FBT08sS0FBS0UsYUFDbENILEVBQU9GLE9BQVNFLEVBQU9SLElBQU1TLEtBQUtHLGdCQUV4QmIsRUFBU0ssTUFBUUksRUFBT04sTUFBUUgsRUFBU0csS0FBT00sRUFBT0osT0FBU0wsRUFBU08sT0FBU0UsRUFBT1IsS0FBT0QsRUFBU0MsSUFBTVEsRUFBT0YsVUFXeEksSUFBSU8sVUFBVyxTQUFVcEIsR0FJckIsR0FBSXFCLE1BS0FDLEVBQVl0QixFQUFFdUIsVUFDZEMsRUFBVXhCLEVBQUVLLE9BNmFoQixPQTNhQWdCLEdBQU1JLFlBQWMsRUFFcEJKLEVBQU1LLGdCQUFrQixFQUV4QkwsRUFBTU0sYUFBZSxFQUNy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bWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJC5mbi5leHRlbmQoe1xuICAgIGlzT25TY3JlZW5WaXNpYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHdpbiA9ICQod2luZG93KTtcbiAgICAgICAgdmFyIHZpZXdwb3J0ID0ge1xuICAgICAgICAgICAgdG9wOiB3aW4uc2Nyb2xsVG9wKCksXG4gICAgICAgICAgICBsZWZ0OiB3aW4uc2Nyb2xsTGVmdCgpXG4gICAgICAgIH07XG4gICAgICAgIHZpZXdwb3J0LnJpZ2h0ID0gdmlld3BvcnQubGVmdCArIHdpbi53aWR0aCgpO1xuICAgICAgICB2aWV3cG9ydC5ib3R0b20gPSB2aWV3cG9ydC50b3AgKyB3aW4uaGVpZ2h0KCk7XG5cbiAgICAgICAgdmFyIGJvdW5kcyA9IHRoaXMub2Zmc2V0KCk7XG4gICAgICAgIGJvdW5kcy5yaWdodCA9IGJvdW5kcy5sZWZ0ICsgdGhpcy5vdXRlcldpZHRoKCk7XG4gICAgICAgIGJvdW5kcy5ib3R0b20gPSBib3VuZHMudG9wICsgdGhpcy5vdXRlckhlaWdodCgpO1xuXG4gICAgICAgIHJldHVybiAoISh2aWV3cG9ydC5yaWdodCA8IGJvdW5kcy5sZWZ0IHx8IHZpZXdwb3J0LmxlZnQgPiBib3VuZHMucmlnaHQgfHwgdmlld3BvcnQuYm90dG9tIDwgYm91bmRzLnRvcCB8fCB2aWV3cG9ydC50b3AgPiBib3VuZHMuYm90dG9tKSk7XG4gICAgfVxufSk7XG5cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gU2Nyb2xsTWVcbi8vIEEgalF1ZXJ5IHBsdWdpbiBmb3IgYWRkaW5nIHNpbXBsZSBzY3JvbGxpbmcgZWZmZWN0cyB0byB3ZWIgcGFnZXNcbi8vIGh0dHA6Ly9zY3JvbGxtZS5uY2twcnNuLmNvbVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG52YXIgc2Nyb2xsbWUgPSAoZnVuY3Rpb24oJCkge1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTY3JvbGxNZSBvYmplY3RcblxuICAgIHZhciBfdGhpcyA9IHt9O1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByb3BlcnRpZXNcblxuICAgIHZhciAkZG9jdW1lbnQgPSAkKGRvY3VtZW50KTtcbiAgICB2YXIgJHdpbmRvdyA9ICQod2luZG93KTtcblxuICAgIF90aGlzLmJvZHlfaGVpZ2h0ID0gMDtcblxuICAgIF90aGlzLnZpZXdwb3J0X2hlaWdodCA9IDA7XG5cbiAgICBfdGhpcy52aWV3cG9ydF90b3AgPSAwO1xuICAgIF90aGlzLnZpZXdwb3J0X2JvdHRvbSA9IDA7XG5cbiAgICBfdGhpcy52aWV3cG9ydF90b3BfcHJldmlvdXMgPSAtMTtcblxuICAgIF90aGlzLmVsZW1lbnRzID0gW107XG4gICAgX3RoaXMuZWxlbWVudHNfaW5fdmlldyA9IFtdO1xuXG4gICAgX3RoaXMucHJvcGVydHlfZGVmYXVsdHMgPSB7XG4gICAgICAgICdvcGFjaXR5JzogMSxcbiAgICAgICAgJ3RyYW5zbGF0ZXgnOiAwLFxuICAgICAgICAndHJhbnNsYXRleSc6IDAsXG4gICAgICAgICd0cmFuc2xhdGV6JzogMCxcbiAgICAgICAgJ3JvdGF0ZXgnOiAwLFxuICAgICAgICAncm90YXRleSc6IDAsXG4gICAgICAgICdyb3RhdGV6JzogMCxcbiAgICAgICAgJ3NjYWxlJzogMSxcbiAgICAgICAgJ3NjYWxleCc6IDEsXG4gICAgICAgICdzY2FsZXknOiAxLFxuICAgICAgICAnc2NhbGV6JzogMVxuICAgIH07XG5cbiAgICBfdGhpcy5zY3JvbGxtZV9zZWxlY3RvciA9ICcuc2Nyb2xsbWUnO1xuICAgIF90aGlzLmFuaW1hdGVtZV9zZWxlY3RvciA9ICcuYW5pbWF0ZW1lJztcblxuICAgIF90aGlzLnVwZGF0ZV9pbnRlcnZhbCA9IDEwO1xuXG4gICAgLy8gRWFzaW5nIGZ1bmN0aW9uc1xuXG4gICAgX3RoaXMuZWFzaW5nX2Z1bmN0aW9ucyA9IHtcbiAgICAgICAgJ2xpbmVhcic6IGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAgIHJldHVybiB4O1xuICAgICAgICB9LFxuXG4gICAgICAgICdlYXNlb3V0JzogZnVuY3Rpb24oeCkge1xuICAgICAgICAgICAgcmV0dXJuIHggKiB4ICogeDtcbiAgICAgICAgfSxcblxuICAgICAgICAnZWFzZWluJzogZnVuY3Rpb24oeCkge1xuICAgICAgICAgICAgeCA9IDEgLSB4O1xuICAgICAgICAgICAgcmV0dXJuIDEgLSAoeCAqIHggKiB4KTtcbiAgICAgICAgfSxcblxuICAgICAgICAnZWFzZWlub3V0JzogZnVuY3Rpb24oeCkge1xuICAgICAgICAgICAgaWYgKHggPCAwLjUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDQgKiB4ICogeCAqIHgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4ID0gMSAtIHg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDEgLSAoNCAqIHggKiB4ICogeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gRG9jdW1lbnQgZXZlbnRzIHRvIGJpbmQgaW5pdGlhbGlzYXRpb24gdG9cblxuICAgIF90aGlzLmluaXRfZXZlbnRzID0gW1xuICAgICAgICAncmVhZHknLFxuICAgICAgICAncGFnZTpsb2FkJywgLy8gVHVyYm9saW5rc1xuICAgICAgICAncGFnZTpjaGFuZ2UnIC8vIFR1cmJvbGlua3NcbiAgICBdO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEluaXRpYWxpc2F0aW9uIGNvbmRpdGlvbnNcblxuICAgIF90aGlzLmluaXRfaWYgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEluaXRpYWxpc2F0aW9uXG5cbiAgICBfdGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIENhbmNlbCBpZiBpbml0aWFsaXNhdGlvbiBjb25kaXRpb25zIG5vdCBtZXRcblxuICAgICAgICBpZiAoIV90aGlzLmluaXRfaWYoKSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIC8vIExvYWQgYWxsIGVsZW1lbnRzIHRvIGFuaW1hdGVcblxuICAgICAgICBfdGhpcy5pbml0X2VsZW1lbnRzKCk7XG5cbiAgICAgICAgLy8gR2V0IGVsZW1lbnQgJiB2aWV3cG9ydCBzaXplc1xuXG4gICAgICAgIF90aGlzLm9uX3Jlc2l6ZSgpO1xuXG4gICAgICAgIC8vIFJlY2FsY3VsYXRlIGhlaWdodHMgJiBwb3NpdGlvbnMgb24gcmVzaXplIGFuZCByb3RhdGVcblxuICAgICAgICAkd2luZG93Lm9uKCdyZXNpemUgb3JpZW50YXRpb25jaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIF90aGlzLm9uX3Jlc2l6ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZWNhbGN1bGF0ZSBoZWlnaHRzICYgcG9zaXRpb25zIHdoZW4gcGFnZSBpcyBmdWxseSBsb2FkZWQgKyBhIGJpdCBqdXN0IGluIGNhc2VcblxuICAgICAgICAkd2luZG93LmxvYWQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLm9uX3Jlc2l6ZSgpO1xuICAgICAgICAgICAgfSwgMTAwKVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTdGFydCBhbmltYXRpbmdcblxuICAgICAgICBzZXRJbnRlcnZhbChfdGhpcy51cGRhdGUsIF90aGlzLnVwZGF0ZV9pbnRlcnZhbCk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEdldCBsaXN0IGFuZCBwcmUtbG9hZCBhbmltYXRlZCBlbGVtZW50c1xuXG4gICAgX3RoaXMuaW5pdF9lbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBGb3IgZWFjaCByZWZlcmVuY2UgZWxlbWVudFxuXG4gICAgICAgICQoX3RoaXMuc2Nyb2xsbWVfc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHt9O1xuXG4gICAgICAgICAgICBlbGVtZW50LmVsZW1lbnQgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICB2YXIgZWZmZWN0cyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBGb3IgZWFjaCBhbmltYXRlZCBlbGVtZW50XG5cbiAgICAgICAgICAgICQodGhpcykuZmluZChfdGhpcy5hbmltYXRlbWVfc2VsZWN0b3IpLmFkZEJhY2soX3RoaXMuYW5pbWF0ZW1lX3NlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIEdldCBlZmZlY3QgZGV0YWlsc1xuXG4gICAgICAgICAgICAgICAgdmFyIGVmZmVjdCA9IHt9O1xuXG4gICAgICAgICAgICAgICAgZWZmZWN0LmVsZW1lbnQgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgZWZmZWN0LndoZW4gPSBlZmZlY3QuZWxlbWVudC5kYXRhKCd3aGVuJyk7XG4gICAgICAgICAgICAgICAgZWZmZWN0LmZyb20gPSBlZmZlY3QuZWxlbWVudC5kYXRhKCdmcm9tJyk7XG4gICAgICAgICAgICAgICAgZWZmZWN0LnRvID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgndG8nKTtcblxuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtY3JvcF0nKSkge1xuICAgICAgICAgICAgICAgICAgICBlZmZlY3QuY3JvcCA9IGVmZmVjdC5lbGVtZW50LmRhdGEoJ2Nyb3AnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlZmZlY3QuY3JvcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGVmZmVjdC5lbGVtZW50LmlzKCdbZGF0YS1lYXNpbmddJykpIHtcbiAgICAgICAgICAgICAgICAgICAgZWZmZWN0LmVhc2luZyA9IF90aGlzLmVhc2luZ19mdW5jdGlvbnNbZWZmZWN0LmVsZW1lbnQuZGF0YSgnZWFzaW5nJyldXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZWZmZWN0LmVhc2luZyA9IF90aGlzLmVhc2luZ19mdW5jdGlvbnNbJ2Vhc2VvdXQnXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgYW5pbWF0ZWQgcHJvcGVydGllc1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb3BlcnRpZXMgPSB7fTtcblxuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtb3BhY2l0eV0nKSkgcHJvcGVydGllcy5vcGFjaXR5ID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgnb3BhY2l0eScpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtdHJhbnNsYXRleF0nKSkgcHJvcGVydGllcy50cmFuc2xhdGV4ID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgndHJhbnNsYXRleCcpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtdHJhbnNsYXRleV0nKSkgcHJvcGVydGllcy50cmFuc2xhdGV5ID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgndHJhbnNsYXRleScpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtdHJhbnNsYXRlel0nKSkgcHJvcGVydGllcy50cmFuc2xhdGV6ID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgndHJhbnNsYXRleicpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtcm90YXRleF0nKSkgcHJvcGVydGllcy5yb3RhdGV4ID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgncm90YXRleCcpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtcm90YXRleV0nKSkgcHJvcGVydGllcy5yb3RhdGV5ID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgncm90YXRleScpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtcm90YXRlel0nKSkgcHJvcGVydGllcy5yb3RhdGV6ID0gZWZmZWN0LmVsZW1lbnQuZGF0YSgncm90YXRleicpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtc2NhbGVdJykpIHByb3BlcnRpZXMuc2NhbGUgPSBlZmZlY3QuZWxlbWVudC5kYXRhKCdzY2FsZScpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtc2NhbGV4XScpKSBwcm9wZXJ0aWVzLnNjYWxleCA9IGVmZmVjdC5lbGVtZW50LmRhdGEoJ3NjYWxleCcpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtc2NhbGV5XScpKSBwcm9wZXJ0aWVzLnNjYWxleSA9IGVmZmVjdC5lbGVtZW50LmRhdGEoJ3NjYWxleScpO1xuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuZWxlbWVudC5pcygnW2RhdGEtc2NhbGV6XScpKSBwcm9wZXJ0aWVzLnNjYWxleiA9IGVmZmVjdC5lbGVtZW50LmRhdGEoJ3NjYWxleicpO1xuXG4gICAgICAgICAgICAgICAgZWZmZWN0LnByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzO1xuXG4gICAgICAgICAgICAgICAgZWZmZWN0cy5wdXNoKGVmZmVjdCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZWxlbWVudC5lZmZlY3RzID0gZWZmZWN0cztcblxuICAgICAgICAgICAgX3RoaXMuZWxlbWVudHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFVwZGF0ZSBlbGVtZW50c1xuXG4gICAgX3RoaXMudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfdGhpcy51cGRhdGVfdmlld3BvcnRfcG9zaXRpb24oKTtcblxuICAgICAgICAgICAgaWYgKF90aGlzLnZpZXdwb3J0X3RvcF9wcmV2aW91cyAhPSBfdGhpcy52aWV3cG9ydF90b3ApIHtcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVfZWxlbWVudHNfaW5fdmlldygpO1xuICAgICAgICAgICAgICAgIF90aGlzLmFuaW1hdGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX3RoaXMudmlld3BvcnRfdG9wX3ByZXZpb3VzID0gX3RoaXMudmlld3BvcnRfdG9wO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQW5pbWF0ZSBzdHVmZlxuXG4gICAgX3RoaXMuYW5pbWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBGb3IgZWFjaCBlbGVtZW50IGluIHZpZXdwb3J0XG5cbiAgICAgICAgdmFyIGVsZW1lbnRzX2luX3ZpZXdfbGVuZ3RoID0gX3RoaXMuZWxlbWVudHNfaW5fdmlldy5sZW5ndGg7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50c19pbl92aWV3X2xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IF90aGlzLmVsZW1lbnRzX2luX3ZpZXdbaV07XG5cbiAgICAgICAgICAgIC8vIEZvciBlYWNoIGVmZmVjdFxuXG4gICAgICAgICAgICB2YXIgZWZmZWN0c19sZW5ndGggPSBlbGVtZW50LmVmZmVjdHMubGVuZ3RoO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IGVmZmVjdHNfbGVuZ3RoOyBlKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZWZmZWN0ID0gZWxlbWVudC5lZmZlY3RzW2VdO1xuXG4gICAgICAgICAgICAgICAgLy8gR2V0IGVmZmVjdCBhbmltYXRpb24gYm91bmRhcmllc1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoIChlZmZlY3Qud2hlbikge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd2aWV3JzogLy8gTWFpbnRhaW5lZCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3Bhbic6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBlbGVtZW50LnRvcCAtIF90aGlzLnZpZXdwb3J0X2hlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbmQgPSBlbGVtZW50LmJvdHRvbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2V4aXQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZWxlbWVudC5ib3R0b20gLSBfdGhpcy52aWV3cG9ydF9oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gZWxlbWVudC5ib3R0b207XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZWxlbWVudC50b3AgLSBfdGhpcy52aWV3cG9ydF9oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gZWxlbWVudC50b3A7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBDcm9wIGJvdW5kYXJpZXNcblxuICAgICAgICAgICAgICAgIGlmIChlZmZlY3QuY3JvcCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmQgPiAoX3RoaXMuYm9keV9oZWlnaHQgLSBfdGhpcy52aWV3cG9ydF9oZWlnaHQpKSBlbmQgPSBfdGhpcy5ib2R5X2hlaWdodCAtIF90aGlzLnZpZXdwb3J0X2hlaWdodDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgc2Nyb2xsIHBvc2l0aW9uIG9mIHJlZmVyZW5jZSBzZWxlY3RvclxuXG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbCA9IChfdGhpcy52aWV3cG9ydF90b3AgLSBzdGFydCkgLyAoZW5kIC0gc3RhcnQpO1xuXG4gICAgICAgICAgICAgICAgLy8gR2V0IHJlbGF0aXZlIHNjcm9sbCBwb3NpdGlvbiBmb3IgZWZmZWN0XG5cbiAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IGVmZmVjdFsnZnJvbSddO1xuICAgICAgICAgICAgICAgIHZhciB0byA9IGVmZmVjdFsndG8nXTtcblxuICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSB0byAtIGZyb207XG5cbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsX3JlbGF0aXZlID0gKHNjcm9sbCAtIGZyb20pIC8gbGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgZWFzaW5nXG5cbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsX2Vhc2VkID0gZWZmZWN0LmVhc2luZyhzY3JvbGxfcmVsYXRpdmUpO1xuXG4gICAgICAgICAgICAgICAgLy8gR2V0IG5ldyB2YWx1ZSBmb3IgZWFjaCBwcm9wZXJ0eVxuXG4gICAgICAgICAgICAgICAgdmFyIG9wYWNpdHkgPSBfdGhpcy5hbmltYXRlX3ZhbHVlKHNjcm9sbCwgc2Nyb2xsX2Vhc2VkLCBmcm9tLCB0bywgZWZmZWN0LCAnb3BhY2l0eScpO1xuICAgICAgICAgICAgICAgIHZhciB0cmFuc2xhdGV5ID0gX3RoaXMuYW5pbWF0ZV92YWx1ZShzY3JvbGwsIHNjcm9sbF9lYXNlZCwgZnJvbSwgdG8sIGVmZmVjdCwgJ3RyYW5zbGF0ZXknKTtcbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNsYXRleCA9IF90aGlzLmFuaW1hdGVfdmFsdWUoc2Nyb2xsLCBzY3JvbGxfZWFzZWQsIGZyb20sIHRvLCBlZmZlY3QsICd0cmFuc2xhdGV4Jyk7XG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zbGF0ZXogPSBfdGhpcy5hbmltYXRlX3ZhbHVlKHNjcm9sbCwgc2Nyb2xsX2Vhc2VkLCBmcm9tLCB0bywgZWZmZWN0LCAndHJhbnNsYXRleicpO1xuICAgICAgICAgICAgICAgIHZhciByb3RhdGV4ID0gX3RoaXMuYW5pbWF0ZV92YWx1ZShzY3JvbGwsIHNjcm9sbF9lYXNlZCwgZnJvbSwgdG8sIGVmZmVjdCwgJ3JvdGF0ZXgnKTtcbiAgICAgICAgICAgICAgICB2YXIgcm90YXRleSA9IF90aGlzLmFuaW1hdGVfdmFsdWUoc2Nyb2xsLCBzY3JvbGxfZWFzZWQsIGZyb20sIHRvLCBlZmZlY3QsICdyb3RhdGV5Jyk7XG4gICAgICAgICAgICAgICAgdmFyIHJvdGF0ZXogPSBfdGhpcy5hbmltYXRlX3ZhbHVlKHNjcm9sbCwgc2Nyb2xsX2Vhc2VkLCBmcm9tLCB0bywgZWZmZWN0LCAncm90YXRleicpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IF90aGlzLmFuaW1hdGVfdmFsdWUoc2Nyb2xsLCBzY3JvbGxfZWFzZWQsIGZyb20sIHRvLCBlZmZlY3QsICdzY2FsZScpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZXggPSBfdGhpcy5hbmltYXRlX3ZhbHVlKHNjcm9sbCwgc2Nyb2xsX2Vhc2VkLCBmcm9tLCB0bywgZWZmZWN0LCAnc2NhbGV4Jyk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxleSA9IF90aGlzLmFuaW1hdGVfdmFsdWUoc2Nyb2xsLCBzY3JvbGxfZWFzZWQsIGZyb20sIHRvLCBlZmZlY3QsICdzY2FsZXknKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGV6ID0gX3RoaXMuYW5pbWF0ZV92YWx1ZShzY3JvbGwsIHNjcm9sbF9lYXNlZCwgZnJvbSwgdG8sIGVmZmVjdCwgJ3NjYWxleicpO1xuXG4gICAgICAgICAgICAgICAgLy8gT3ZlcnJpZGUgc2NhbGUgdmFsdWVzXG5cbiAgICAgICAgICAgICAgICBpZiAoJ3NjYWxlJyBpbiBlZmZlY3QucHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZXggPSBzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGV5ID0gc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxleiA9IHNjYWxlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9wZXJ0aWVzXG5cbiAgICAgICAgICAgICAgICBlZmZlY3QuZWxlbWVudC5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAnb3BhY2l0eSc6IG9wYWNpdHksXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlM2QoICcgKyB0cmFuc2xhdGV4ICsgJ3B4ICwgJyArIHRyYW5zbGF0ZXkgKyAncHggLCAnICsgdHJhbnNsYXRleiArICdweCApIHJvdGF0ZVgoICcgKyByb3RhdGV4ICsgJ2RlZyApIHJvdGF0ZVkoICcgKyByb3RhdGV5ICsgJ2RlZyApIHJvdGF0ZVooICcgKyByb3RhdGV6ICsgJ2RlZyApIHNjYWxlM2QoICcgKyBzY2FsZXggKyAnICwgJyArIHNjYWxleSArICcgLCAnICsgc2NhbGV6ICsgJyApJyxcbiAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZTNkKCAnICsgdHJhbnNsYXRleCArICdweCAsICcgKyB0cmFuc2xhdGV5ICsgJ3B4ICwgJyArIHRyYW5zbGF0ZXogKyAncHggKSByb3RhdGVYKCAnICsgcm90YXRleCArICdkZWcgKSByb3RhdGVZKCAnICsgcm90YXRleSArICdkZWcgKSByb3RhdGVaKCAnICsgcm90YXRleiArICdkZWcgKSBzY2FsZTNkKCAnICsgc2NhbGV4ICsgJyAsICcgKyBzY2FsZXkgKyAnICwgJyArIHNjYWxleiArICcgKScsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQ2FsY3VsYXRlIHByb3BlcnR5IHZhbHVlc1xuXG4gICAgX3RoaXMuYW5pbWF0ZV92YWx1ZSA9IGZ1bmN0aW9uKHNjcm9sbCwgc2Nyb2xsX2Vhc2VkLCBmcm9tLCB0bywgZWZmZWN0LCBwcm9wZXJ0eSkge1xuICAgICAgICB2YXIgdmFsdWVfZGVmYXVsdCA9IF90aGlzLnByb3BlcnR5X2RlZmF1bHRzW3Byb3BlcnR5XTtcblxuICAgICAgICAvLyBSZXR1cm4gZGVmYXVsdCB2YWx1ZSBpZiBwcm9wZXJ0eSBpcyBub3QgYW5pbWF0ZWRcblxuICAgICAgICBpZiAoIShwcm9wZXJ0eSBpbiBlZmZlY3QucHJvcGVydGllcykpIHJldHVybiB2YWx1ZV9kZWZhdWx0O1xuXG4gICAgICAgIHZhciB2YWx1ZV90YXJnZXQgPSBlZmZlY3QucHJvcGVydGllc1twcm9wZXJ0eV07XG5cbiAgICAgICAgdmFyIGZvcndhcmRzID0gKHRvID4gZnJvbSkgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgLy8gUmV0dXJuIGJvdW5kYXJ5IHZhbHVlIGlmIG91dHNpZGUgZWZmZWN0IGJvdW5kYXJpZXNcblxuICAgICAgICBpZiAoc2Nyb2xsIDwgZnJvbSAmJiBmb3J3YXJkcykge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlX2RlZmF1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNjcm9sbCA+IHRvICYmIGZvcndhcmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWVfdGFyZ2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNjcm9sbCA+IGZyb20gJiYgIWZvcndhcmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWVfZGVmYXVsdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2Nyb2xsIDwgdG8gJiYgIWZvcndhcmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWVfdGFyZ2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyBwcm9wZXJ0eSB2YWx1ZVxuXG4gICAgICAgIHZhciBuZXdfdmFsdWUgPSB2YWx1ZV9kZWZhdWx0ICsgKHNjcm9sbF9lYXNlZCAqICh2YWx1ZV90YXJnZXQgLSB2YWx1ZV9kZWZhdWx0KSk7XG5cbiAgICAgICAgLy8gUm91bmQgYXMgcmVxdWlyZWRcblxuICAgICAgICBzd2l0Y2ggKHByb3BlcnR5KSB7XG4gICAgICAgICAgICBjYXNlICdvcGFjaXR5JzpcbiAgICAgICAgICAgICAgICBuZXdfdmFsdWUgPSBuZXdfdmFsdWUudG9GaXhlZCgyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RyYW5zbGF0ZXgnOlxuICAgICAgICAgICAgICAgIG5ld192YWx1ZSA9IG5ld192YWx1ZS50b0ZpeGVkKDApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndHJhbnNsYXRleSc6XG4gICAgICAgICAgICAgICAgbmV3X3ZhbHVlID0gbmV3X3ZhbHVlLnRvRml4ZWQoMCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICd0cmFuc2xhdGV6JzpcbiAgICAgICAgICAgICAgICBuZXdfdmFsdWUgPSBuZXdfdmFsdWUudG9GaXhlZCgwKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3JvdGF0ZXgnOlxuICAgICAgICAgICAgICAgIG5ld192YWx1ZSA9IG5ld192YWx1ZS50b0ZpeGVkKDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncm90YXRleSc6XG4gICAgICAgICAgICAgICAgbmV3X3ZhbHVlID0gbmV3X3ZhbHVlLnRvRml4ZWQoMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyb3RhdGV6JzpcbiAgICAgICAgICAgICAgICBuZXdfdmFsdWUgPSBuZXdfdmFsdWUudG9GaXhlZCgxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NjYWxlJzpcbiAgICAgICAgICAgICAgICBuZXdfdmFsdWUgPSBuZXdfdmFsdWUudG9GaXhlZCgzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEb25lXG5cbiAgICAgICAgcmV0dXJuIG5ld192YWx1ZTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gVXBkYXRlIHZpZXdwb3J0IHBvc2l0aW9uXG5cbiAgICBfdGhpcy51cGRhdGVfdmlld3BvcnRfcG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgX3RoaXMudmlld3BvcnRfdG9wID0gJHdpbmRvdy5zY3JvbGxUb3AoKTtcbiAgICAgICAgX3RoaXMudmlld3BvcnRfYm90dG9tID0gX3RoaXMudmlld3BvcnRfdG9wICsgX3RoaXMudmlld3BvcnRfaGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBVcGRhdGUgbGlzdCBvZiBlbGVtZW50cyBpbiB2aWV3XG5cbiAgICBfdGhpcy51cGRhdGVfZWxlbWVudHNfaW5fdmlldyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBfdGhpcy5lbGVtZW50c19pbl92aWV3ID0gW107XG5cbiAgICAgICAgdmFyIGVsZW1lbnRzX2xlbmd0aCA9IF90aGlzLmVsZW1lbnRzLmxlbmd0aDtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzX2xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoKF90aGlzLmVsZW1lbnRzW2ldLnRvcCA8IF90aGlzLnZpZXdwb3J0X2JvdHRvbSkgJiYgKF90aGlzLmVsZW1lbnRzW2ldLmJvdHRvbSA+IF90aGlzLnZpZXdwb3J0X3RvcCkpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5lbGVtZW50c19pbl92aWV3LnB1c2goX3RoaXMuZWxlbWVudHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFN0dWZmIHRvIGRvIG9uIHJlc2l6ZVxuXG4gICAgX3RoaXMub25fcmVzaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFVwZGF0ZSB2aWV3cG9ydC9lbGVtZW50IGRhdGFcblxuICAgICAgICBfdGhpcy51cGRhdGVfdmlld3BvcnQoKTtcbiAgICAgICAgX3RoaXMudXBkYXRlX2VsZW1lbnRfaGVpZ2h0cygpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBkaXNwbGF5XG5cbiAgICAgICAgX3RoaXMudXBkYXRlX3ZpZXdwb3J0X3Bvc2l0aW9uKCk7XG4gICAgICAgIF90aGlzLnVwZGF0ZV9lbGVtZW50c19pbl92aWV3KCk7XG4gICAgICAgIF90aGlzLmFuaW1hdGUoKTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gVXBkYXRlIHZpZXdwb3J0IHBhcmFtZXRlcnNcblxuICAgIF90aGlzLnVwZGF0ZV92aWV3cG9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBfdGhpcy5ib2R5X2hlaWdodCA9ICRkb2N1bWVudC5oZWlnaHQoKTtcbiAgICAgICAgX3RoaXMudmlld3BvcnRfaGVpZ2h0ID0gJHdpbmRvdy5oZWlnaHQoKTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gVXBkYXRlIGhlaWdodCBvZiBhbmltYXRlZCBlbGVtZW50c1xuXG4gICAgX3RoaXMudXBkYXRlX2VsZW1lbnRfaGVpZ2h0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZWxlbWVudHNfbGVuZ3RoID0gX3RoaXMuZWxlbWVudHMubGVuZ3RoO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHNfbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50X2hlaWdodCA9IF90aGlzLmVsZW1lbnRzW2ldLmVsZW1lbnQub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IF90aGlzLmVsZW1lbnRzW2ldLmVsZW1lbnQub2Zmc2V0KCk7XG5cbiAgICAgICAgICAgIF90aGlzLmVsZW1lbnRzW2ldLmhlaWdodCA9IGVsZW1lbnRfaGVpZ2h0O1xuICAgICAgICAgICAgX3RoaXMuZWxlbWVudHNbaV0udG9wID0gcG9zaXRpb24udG9wO1xuICAgICAgICAgICAgX3RoaXMuZWxlbWVudHNbaV0uYm90dG9tID0gcG9zaXRpb24udG9wICsgZWxlbWVudF9oZWlnaHQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQmluZCBpbml0aWFsaXNhdGlvblxuXG4gICAgJGRvY3VtZW50Lm9uKF90aGlzLmluaXRfZXZlbnRzLmpvaW4oJyAnKSwgZnVuY3Rpb24oKSB7XG4gICAgICAgIF90aGlzLmluaXQoKTtcbiAgICB9KTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIHJldHVybiBfdGhpcztcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxufSk7XG5cblxuXG52YXIgRHVvc2h1byA9IHtcblxuICAgIGRhdGFUaHJlYWRLZXk6IGxvY2F0aW9uLnByb3RvY29sICsgJy8vJyArIGxvY2F0aW9uLmhvc3QgKyBsb2NhdGlvbi5wYXRobmFtZSxcblxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBEdW9zaHVvLnRvZ2dsZUJveCgpO1xuICAgIH0sXG5cbiAgICB0b2dnbGVCb3g6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQoJy50b2dnbGUtY29tbWVudCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ+W8gOWQr+ivhOiuuicpO1xuICAgICAgICAgICAgaWYgKCQoJy5jb21tZW50LWFyZWEnKS5oYXMoJ2RpdicpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAkKCcuY29tbWVudC1hcmVhJykuZW1wdHkoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS10aHJlYWQta2V5JywgRHVvc2h1by5kYXRhVGhyZWFkS2V5KTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS11cmwnLCBsb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgICAgIERVT1NIVU8uRW1iZWRUaHJlYWQoZWwpO1xuICAgICAgICAgICAgJCgnLmNvbW1lbnQtYXJlYScpLmFwcGVuZChlbCk7XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJCgnLmNvbW1lbnQtYXJlYScpLmFkZENsYXNzKCd0b2dnbGUtdXAnKTtcbiAgICAgICAgICAgIH0sIDUwMClcblxuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICgkKCcuY29tbWVudC1hcmVhJykuaXNPblNjcmVlblZpc2libGUoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy50b2dnbGUtY29tbWVudCcpLmFkZENsYXNzKCdhbmltYXRlZCBmYWRlT3V0JykuZmFkZU91dCg1MDApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwMClcblxuXG5cbiAgICAgICAgfSlcblxuICAgIH1cbn1cblxuXG5cblxudmFyIEdlbmVyYWwgPSB7XG4gICAgaXNXZWl4aW46IGZhbHNlLFxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBHZW5lcmFsLnNjcm9sbFRvUG9zKCk7XG4gICAgICAgIEdlbmVyYWwuY2hlY2tLZXkoKTtcbiAgICAgICAgR2VuZXJhbC51cGRhdGVJbWFnZVdpZHRoKCk7XG4gICAgICAgIHZhciBVQSA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBpZiAoVUEubWF0Y2goL01pY3JvTWVzc2VuZ2VyL2kpID09IFwibWljcm9tZXNzZW5nZXJcIikge1xuICAgICAgICAgICAgR2VuZXJhbC5pc1dlaXhpbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy/mqKHmi5/pvKDmoIfkuIrkuIvmu5rliqhcbiAgICBjaGVja0tleTogZnVuY3Rpb24oZSkge1xuICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gJzc0Jykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+aMieS4i+mUruebmCcpO1xuICAgICAgICAgICAgJCgnaHRtbCxib2R5Jykuc3RvcCgpO1xuICAgICAgICAgICAgJCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKHdpbmRvdykuc3RvcCgpLnNjcm9sbFRvcCgpICsgMjAwXG4gICAgICAgICAgICB9LCAnZmFzdCcpXG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09ICc3NScpIHtcbiAgICAgICAgICAgICQoJ2h0bWwsYm9keScpLnN0b3AoKTtcbiAgICAgICAgICAgICQoJ2h0bWwsYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogJCh3aW5kb3cpLnN0b3AoKS5zY3JvbGxUb3AoKSAtIDIwMFxuICAgICAgICAgICAgfSwgJ2Zhc3QnKVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHVwZGF0ZUltYWdlV2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJHBvc3RDb250ZW50ID0gJChcIi5wb3N0LWNvbnRlbnRcIik7XG4gICAgICAgICRwb3N0Q29udGVudC5maXRWaWRzKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlSW1hZ2VXaWR0aCgpIHtcbiAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgY29udGVudFdpZHRoID0gJHBvc3RDb250ZW50Lm91dGVyV2lkdGgoKSwgLy8gV2lkdGggb2YgdGhlIGNvbnRlbnRcbiAgICAgICAgICAgICAgICBpbWFnZVdpZHRoID0gdGhpcy5uYXR1cmFsV2lkdGg7IC8vIE9yaWdpbmFsIGltYWdlIHJlc29sdXRpb25cblxuICAgICAgICAgICAgaWYgKGltYWdlV2lkdGggPj0gY29udGVudFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3MoJ2Z1bGwtaW1nJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKCdmdWxsLWltZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyICRpbWcgPSAkKFwiLnNpbmdsZS1wb3N0LWlubmVyIGltZ1wiKS5vbignbG9hZCcsIHVwZGF0ZUltYWdlV2lkdGgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNhc3BlckZ1bGxJbWcoKSB7XG4gICAgICAgICAgICAkaW1nLmVhY2godXBkYXRlSW1hZ2VXaWR0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBjYXNwZXJGdWxsSW1nKCk7XG4gICAgfSxcblxuICAgIC8q57uZ5paH56ug5Lit55qEdXJs5re75YqgaWNvbmZvbnTmlrnkvr/or4bliKsqL1xuICAgIHVybEljb25saXplOiBmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgdmFyIGRvbWFpbixcbiAgICAgICAgICAgIF9vdXRwdXQ7XG4gICAgICAgIHZhciBpY29uTWFwID0geyAvKue0ouW8lSDlj6/lnKjov5nph4zmt7vliqDljLnphY3op4TliJkqL1xuICAgICAgICAgICAgJ3R3aXR0ZXInOiAnaWNvbi10d2l0dGVyJyxcbiAgICAgICAgICAgICdxem9uZSc6ICdpY29uLXF6b25lJyxcbiAgICAgICAgICAgICd3ZWlibyc6ICdpY29uLXdlaWJvJyxcbiAgICAgICAgICAgICdmYWNlYm9vayc6ICdpY29uLWZhY2Vib29rJyxcbiAgICAgICAgICAgICdnaXRodWInOiAnaWNvbi1naXRodWInLFxuICAgICAgICAgICAgJ2RvdWJhbic6ICdpY29uLWRvdWJhbicsXG4gICAgICAgICAgICAnZ29vZ2xlJzogJ2ljb24tZ29vZ2xlJyxcbiAgICAgICAgICAgICdsdW9sZWknOiAnaWNvbi1sdW9sZWknLFxuICAgICAgICAgICAgJ2RyaWJibGUnOiAnaWNvbi1kcmliYmxlJ1xuXG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBuYW1lIGluIGljb25NYXApIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaWNvbk1hcFtuYW1lXSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHZhciBNYXBLZXkgPSBuYW1lO1xuICAgICAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZihNYXBLZXkpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tYWluID0gTWFwS2V5O1xuICAgICAgICAgICAgICAgICAgICBfb3V0cHV0ID0gaWNvbk1hcFtNYXBLZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBfb3V0cHV0O1xuICAgIH0sXG5cbiAgICBhZGRJY29uczogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8q57uZ5Y2a5a6i5paH56ug5Zyw5Z2AdXJs5re75YqgaWNv6K+G5YirKi9cbiAgICAgICAgJCgnLnNpbmdsZS1wb3N0LWlubmVyIHAgYTpub3QoOmhhcyhpbWcpKScpLmVhY2goZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgdmFyIF9zcmMgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgIHZhciB0bXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICB0bXAuaHJlZiA9IF9zcmM7XG4gICAgICAgICAgICBfc2VsZkRvbWFpbiA9IHRtcC5ob3N0bmFtZTtcbiAgICAgICAgICAgIEdlbmVyYWwudXJsSWNvbmxpemUoX3NlbGZEb21haW4pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coX3NlbGZEb21haW4pO1xuICAgICAgICAgICAgLy8kKHRoaXMpLmFwcGVuZCh1cmxJY29ubGl6ZShfc2VsZkRvbWFpbikpO1xuICAgICAgICAgICAgJCh0aGlzKS5wcmVwZW5kKCc8aSBjbGFzcz1cImljb25mb250ICcgKyBHZW5lcmFsLnVybEljb25saXplKF9zZWxmRG9tYWluKSArICdcIj48L2k+Jyk7XG4gICAgICAgICAgICB2YXIgX3NlbGZDb2xvciA9ICQodGhpcykuZmluZCgnaScpLmNzcygnY29sb3InKSxcbiAgICAgICAgICAgICAgICBfb3JpZ2luYWxDb2xvciA9ICQodGhpcykuY3NzKCdjb2xvcicpO1xuXG4gICAgICAgICAgICAvKum8oOagh+aCrOa1ruaXtiovXG4gICAgICAgICAgICAkKHRoaXMpLmhvdmVyKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdjb2xvcicsIF9zZWxmQ29sb3IpO1xuICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FuaW1hdGVkIHB1bHNlJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcygnY29sb3InLCBfb3JpZ2luYWxDb2xvcik7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYW5pbWF0ZWQgcHVsc2UnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvL+W5s+a7kea7muWKqOWIsOmhtumDqFxuICAgIHNjcm9sbFRvUG9zOiBmdW5jdGlvbihwb3NpdGlvbikge1xuICAgICAgICB2YXIgU1RSX1RPX1RPUCA9ICfmiJHopoHpo57liLDmnIDpq5gnLFxuICAgICAgICAgICAgY292ZXJIZWlnaHQgPSBwb3NpdGlvbiB8fCAkKHdpbmRvdykuaGVpZ2h0KCk7IC8v6I635b6X5Zu+54mH6auY5bqmXG4gICAgICAgIHZhciBidXR0b24gPSAkKCc8YSBocmVmPVwiI1wiIGlkPVwidG8tdG9wXCIgdGl0bGU9XCInICsgU1RSX1RPX1RPUCArICdcIj4gPGRpdiBjbGFzcz1cInRvLXRvcC13cmFwXCI+PC9kaXY+PC9hPicpLmFwcGVuZFRvKCdib2R5Jyk7XG4gICAgICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gJCh3aW5kb3cpLmhlaWdodCgpKSB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmZhZGVJbig1MDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBidXR0b24uZmFkZU91dCg1MDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBidXR0b24uY2xpY2soZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgJCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wOiBjb3ZlckhlaWdodCAtIDUwXG4gICAgICAgICAgICB9LCAxMDAwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICcjJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+aIkei3sycpO1xuICAgICAgICB9KVxuICAgIH0sXG4gICAgLy/lpITnkIblsY/luZXlj5jljJbml7ZcbiAgICByZXNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2aXN1YWxDb250YWluZXJXaWRoID0gJCh3aW5kb3cpLndpZHRoKCk7XG4gICAgICAgIC8vIGNvbnRlbnRXaWR0aD0kKCcucG9zdC1jb250ZW50Jykud2lkdGgoKTtcbiAgICAgICAgLy8gJCgnLnNpbmdsZS1wb3N0LWlubmVyIGltZycpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICB2YXIgX2ltZyA9ICQodGhpcyk7XG4gICAgICAgIC8vICAgICBjaGVja0ltZyhfaW1nKTtcbiAgICAgICAgLy8gfSlcbiAgICB9XG5cblxuXG59XG5cblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgR2VuZXJhbC5pbml0KCk7XG4gICAgaWYgKEdlbmVyYWwuaXNXZWl4aW4gPT0gZmFsc2UpIHtcbiAgICAgICAgc2Nyb2xsbWUoJCk7XG4gICAgfVxuXG4gICAgLy8g5Yqg6L295aSa6K+06K+E6K66XG5cblxuICAgIC8vIOaWh+eroOmhtVxuICAgIGlmICgkKCdib2R5JykuaGFzQ2xhc3MoJ3Bvc3QtdGVtcGxhdGUnKSkge1xuICAgICAgICBHZW5lcmFsLnVwZGF0ZUltYWdlV2lkdGgoKTtcbiAgICAgICAgJCgnaW1nW2FsdD1cImNvdmVyXCJdJykuYWRkQ2xhc3MoJ2NvdmVyLWltYWdlJyk7XG4gICAgICAgIEdlbmVyYWwuYWRkSWNvbnMoKTtcblxuICAgICAgICAkKCcuc2hhcmUgaDQnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQoJy5zaGFyZS1pY29ucycpLmNzcygnZGlzcGxheScsICdibG9jaycpLmFkZENsYXNzKCdmYWRlSW5VcEJpZyBhbmltYXRlZCcpXG4gICAgICAgICAgICAkKHRoaXMpLmZhZGVPdXQoNTAwKTtcblxuICAgICAgICB9KVxuXG5cbiAgICAgICAgRHVvc2h1by5pbml0KCk7XG4gICAgICAgICQoJy5zaW5nbGUtcG9zdC1pbm5lciBwOmhhcyhpbWcpJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICBfdGhpcy5hZGRDbGFzcygnd2l0aC1pbWcnKTtcblxuICAgICAgICAgICAgaWYgKF90aGlzLmlzT25TY3JlZW5WaXNpYmxlKCkgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFkZENsYXNzKCd3aXRoLWltZycpLmFkZENsYXNzKCdhbHJlYWR5LXZpc2libGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyDliJfooajpobVcblxuICAgIGlmICgkKCdib2R5JykuaGFzQ2xhc3MoJ2FyY2hpdmUtdGVtcGxhdGUnKSB8fCAkKCdib2R5JykuaGFzQ2xhc3MoJ2hvbWUtdGVtcGxhdGUnKSkge1xuICAgICAgICAkKCcucG9zdC1pbi1saXN0JykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNPblNjcmVlblZpc2libGUoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuYWRkQ2xhc3MoJ2FscmVhZHktdmlzaWJsZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgICQoJy5wb3N0LWV4Y2VycHQnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gJCh0aGlzKTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5oYXMoJ2ltZycpLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+ayoeacieWbvueJhycpO1xuICAgICAgICAgICAgICAgIF90aGlzLmFwcGVuZCgnPGltZyBzcmM9XCJodHRwczovL2x1b2xlaW9yZy5iMC51cGFpeXVuLmNvbS90bXAvbmV2LXNldC5qcGdcIj48L2ltZz4nKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV2l0aCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuXG5cblxuXG5cblxuICAgICQoJy5hcnJvd19kb3duJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICQoJ2h0bWwsYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKHdpbmRvdykuaGVpZ2h0KCkgLSAyMFxuICAgICAgICB9LCAxMDAwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJyMnO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pXG5cblxuICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgaWYgKCQod2luZG93KS5zY3JvbGxUb3AoKSA+IDUwKSB7XG4gICAgICAgICAgICAvLyAkKCcubmF2LWhlYWRlcicpLnJlbW92ZUNsYXNzKCdoaWRlJykuYWRkQ2xhc3MoJ2ZhZGVJbkRvd25CaWcgYW5pbWF0ZWQnKVxuICAgICAgICB9XG5cblxuICAgICAgICBpZiAoJCgnYm9keScpLmhhc0NsYXNzKCdwb3N0LXRlbXBsYXRlJykpIHtcbiAgICAgICAgICAgIGlmICgkKCcuc2hhcmUtaWNvbnMnKS5pc09uU2NyZWVuVmlzaWJsZSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgJCgnLnNoYXJlLWljb25zJykucmVtb3ZlQ2xhc3MoJ2ZhZGVJblVwQmlnIGFuaW1hdGVkJykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKVxuICAgICAgICAgICAgICAgICQoJy5zaGFyZSBoNCcpLmNzcygnZGlzcGxheScsICdibG9jaycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKEdlbmVyYWwuaXNXZWl4aW4gPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGlmICgkKCcuY29weXJpZ2h0JykuaXNPblNjcmVlblZpc2libGUoKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmmL7npLrkuoYnKTtcbiAgICAgICAgICAgICAgICAgICAgJCgnLndlY2hhdC1ub3RpY2UnKS5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKS5hZGRDbGFzcygnZmFkZUluVXBCaWcgYW5pbWF0ZWQnKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCQoJ2JvZHknKS5oYXNDbGFzcygnYXJjaGl2ZS10ZW1wbGF0ZScpIHx8ICQoJ2JvZHknKS5oYXNDbGFzcygnaG9tZS10ZW1wbGF0ZScpKSB7XG4gICAgICAgICAgICAkKCcucG9zdC1pbi1saXN0JykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc09uU2NyZWVuVmlzaWJsZSgpID09IHRydWUgJiYgX3RoaXMuaGFzQ2xhc3MoJ2FscmVhZHktdmlzaWJsZScpICE9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuYWRkQ2xhc3MoJ2ZhZGVJblVwQmlnIGFuaW1hdGVkJylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICB9KVxuXG59KVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9