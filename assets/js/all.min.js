$.fn.extend({isOnScreenVisible:function(){var o=$(window),e={top:o.scrollTop(),left:o.scrollLeft()};e.right=e.left+o.width(),e.bottom=e.top+o.height();var t=this.offset();return t.right=t.left+this.outerWidth(),t.bottom=t.top+this.outerHeight(),!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}});var Duoshuo={dataThreadKey:location.protocol+"//"+location.host+location.pathname,init:function(){Duoshuo.toggleBox()},toggleBox:function(){$(".toggle-comment").on("click",function(){if($(".comment-area").has("div").length>0)return void $(".comment-area").empty();var o=document.createElement("div");o.setAttribute("data-thread-key",Duoshuo.dataThreadKey),o.setAttribute("data-url",location.href),DUOSHUO.EmbedThread(o),$(".comment-area").append(o),setTimeout(function(){$(".comment-area").addClass("toggle-up")},500),setTimeout(function(){1==$(".comment-area").isOnScreenVisible()&&$(".toggle-comment").addClass("animated fadeOut").fadeOut(500)},1e3)})}},General={init:function(){General.scrollToPos(),General.checkKey(),General.updateImageWidth()},checkKey:function(o){o=o||window.event,"74"==o.keyCode?(console.log("按下键盘"),$("html,body").stop(),$("html,body").animate({scrollTop:$(window).stop().scrollTop()+200},"fast")):"75"==o.keyCode&&($("html,body").stop(),$("html,body").animate({scrollTop:$(window).stop().scrollTop()-200},"fast"))},updateImageWidth:function(){function o(){var o=$(this),e=t.outerWidth(),i=this.naturalWidth;i>=e?o.addClass("full-img"):o.removeClass("full-img")}function e(){i.each(o)}var t=$(".post-content");t.fitVids();var i=$(".single-post-inner img").on("load",o);e()},urlIconlize:function(o){var e,t,i={twitter:"icon-twitter",qzone:"icon-qzone",weibo:"icon-weibo",facebook:"icon-facebook",github:"icon-github",douban:"icon-douban",google:"icon-google",luolei:"icon-luolei",dribble:"icon-dribble"};for(var n in i)if("function"!=typeof i[n]){var a=n;o.indexOf(a)>=0&&(e=a,t=i[a])}return t},addIcons:function(){$(".single-post-inner p a:not(:has(img))").each(function(){var o=$(this).attr("href"),e=document.createElement("a");e.href=o,_selfDomain=e.hostname,General.urlIconlize(_selfDomain),console.log(_selfDomain),$(this).prepend('<i class="iconfont '+General.urlIconlize(_selfDomain)+'"></i>');var t=$(this).find("i").css("color"),i=$(this).css("color");$(this).hover(function(){$(this).css("color",t),$(this).addClass("animated pulse")},function(){$(this).css("color",i),$(this).removeClass("animated pulse")})})},scrollToPos:function(o){var e="我要飞到最高",t=o||$(window).height(),i=$('<a href="#" id="to-top" title="'+e+'"> <div class="to-top-wrap"></div></a>').appendTo("body");$(window).scroll(function(){$(window).scrollTop()>$(window).height()?i.fadeIn(500):i.fadeOut(500)}),i.click(function(o){o.preventDefault(),$("html,body").animate({scrollTop:t-50},1e3,function(){window.location.hash="#"}),console.log("我跳")})},resize:function(){visualContainerWidh=$(window).width()}};$(document).ready(function(){General.init(),General.updateImageWidth(),Duoshuo.init(),$(".single-post-inner p:has(img)").each(function(){var o=$(this);o.addClass("with-img"),1==o.isOnScreenVisible()&&o.addClass("with-img").addClass("already-visible")}),$(".post-in-list").each(function(){var o=$(this);1==o.isOnScreenVisible()&&o.addClass("already-visible")}),$(".share h4").on("click",function(){$(".share-icons").css("display","block").addClass("fadeInUpBig animated"),$(this).fadeOut(500)}),$("#header").click(function(){return console.log("下滑"),$("html,body").animate({scrollTop:$(window).height()-20},1e3,function(){}),!1}),$("body").hasClass("post-template")&&($('img[alt="cover"]').addClass("cover-image"),General.addIcons()),($("body").hasClass("archive-template")||$("body").hasClass("home-template"))&&$(".post-excerpt").each(function(){var o=$(this);0==o.has("img").length?(console.log("没有图片"),o.append('<img src="https://luoleiorg.b0.upaiyun.com/tmp/nev-set.jpg"></img>')):console.log("With")}),$(window).scroll(function(){$(window).scrollTop()>50,0==$(".share-icons").isOnScreenVisible()&&($(".share-icons").removeClass("fadeInUpBig animated").css("display","none"),$(".share h4").css("display","block")),($("body").hasClass("archive-template")||$("body").hasClass("home-template"))&&$(".post-in-list").each(function(){var o=$(this);1==o.isOnScreenVisible()&&1!=o.hasClass("already-visible")&&o.addClass("fadeInUpBig animated")})})});
